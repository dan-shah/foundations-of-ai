
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Part 3.2: Optimization &amp; Linear Programming &#8212; Foundations of AI</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=9c3e77be" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=1ae7504c"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/07_optimization_linear_programming';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Part 3.3: Optimization Theory for Machine Learning" href="08_optimization_theory.html" />
    <link rel="prev" title="Part 3.1: Classical Machine Learning" href="06_classical_ml.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
  
    <p class="title logo__title">Foundations of AI</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 1: Mathematical Foundations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="01_linear_algebra.html">Part 1.1: Linear Algebra for Deep Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="02_calculus.html">Part 1.2: Calculus for Deep Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="03_probability_statistics.html">Part 1.3: Probability &amp; Statistics for Deep Learning</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 2: Programming Foundations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="04_python_oop.html">Part 2.1: Python OOP for Deep Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="05_numpy_deep_dive.html">Part 2.2: NumPy Deep Dive</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 3: Classical ML &amp; Optimization</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="06_classical_ml.html">Part 3.1: Classical Machine Learning</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Part 3.2: Optimization &amp; Linear Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="08_optimization_theory.html">Part 3.3: Optimization Theory for Machine Learning</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 4: Neural Network Fundamentals</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="09_perceptrons_basic_networks.html">Part 4.1: Perceptrons &amp; Basic Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="10_backpropagation.html">Part 4.2: Backpropagation</a></li>
<li class="toctree-l1"><a class="reference internal" href="11_pytorch_fundamentals.html">Part 4.3: PyTorch Fundamentals</a></li>
<li class="toctree-l1"><a class="reference internal" href="12_training_deep_networks.html">Part 4.4: Training Deep Networks</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 5: Neural Network Architectures</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="13_convolutional_neural_networks.html">Part 5.1: Convolutional Neural Networks (CNNs)</a></li>
<li class="toctree-l1"><a class="reference internal" href="14_computer_vision_depth.html">Part 5.2: Computer Vision — Beyond Classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="15_recurrent_neural_networks.html">Part 5.3: Recurrent Neural Networks (RNNs)</a></li>
<li class="toctree-l1"><a class="reference internal" href="16_attention_mechanisms.html">Part 5.4: Attention Mechanisms</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 6: Transformers &amp; LLMs</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="17_transformer_architecture.html">Part 6.1: Transformer Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="18_embeddings.html">Part 6.2: Embeddings</a></li>
<li class="toctree-l1"><a class="reference internal" href="19_tokenization_lm_training.html">Part 6.3: Tokenization &amp; Language Model Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="20_language_models.html">Part 6.4: Language Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="21_finetuning_and_peft.html">Part 6.5: Fine-tuning &amp; PEFT</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 7: Reinforcement Learning</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="22_rl_fundamentals.html">Part 7.1: Reinforcement Learning Fundamentals</a></li>
<li class="toctree-l1"><a class="reference internal" href="23_q_learning_dqn.html">Part 7.2: Q-Learning and Deep Q-Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="24_policy_gradients.html">Part 7.3: Policy Gradient Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="25_ppo_modern_rl.html">Part 7.4: PPO and Modern RL</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 8: Applied AI Systems</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="26_rag.html">Part 8.1: Retrieval-Augmented Generation (RAG)</a></li>
<li class="toctree-l1"><a class="reference internal" href="27_ai_agents.html">Part 8.2: AI Agents and Tool Use</a></li>
<li class="toctree-l1"><a class="reference internal" href="28_ai_evals.html">Part 8.3: Evaluating AI Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="29_production_monitoring.html">Part 8.4: Production AI Systems</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 9: Advanced Topics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="30_inference_optimization.html">Part 9.1: LLM Inference Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="31_ml_systems.html">Part 9.2: ML Systems &amp; Experiment Tracking</a></li>
<li class="toctree-l1"><a class="reference internal" href="32_multimodal_ai.html">Part 9.3: Multimodal AI</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/dan-shah/foundations-of-ai/blob/main/notebooks/07_optimization_linear_programming.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/dan-shah/foundations-of-ai" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/dan-shah/foundations-of-ai/edit/main/notebooks/07_optimization_linear_programming.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/dan-shah/foundations-of-ai/issues/new?title=Issue%20on%20page%20%2Fnotebooks/07_optimization_linear_programming.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/notebooks/07_optimization_linear_programming.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Part 3.2: Optimization & Linear Programming</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-objectives">Learning Objectives</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-optimization">1. What is Optimization?</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#intuitive-explanation">Intuitive Explanation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-f1-connection">The F1 Connection</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deep-dive-types-of-optimization-problems">Deep Dive: Types of Optimization Problems</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#key-insight">Key Insight</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-programming">2. Linear Programming</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Intuitive Explanation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#breaking-down-the-formula">Breaking down the formula:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">The F1 Connection</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#geometric-intuition">Geometric Intuition</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deep-dive-why-lps-always-have-vertex-solutions">Deep Dive: Why LPs Always Have Vertex Solutions</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#common-misconceptions">Common Misconceptions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-simplex-method">3. The Simplex Method</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Intuitive Explanation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">The F1 Connection</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deep-dive-simplex-vs-interior-point-methods">Deep Dive: Simplex vs Interior Point Methods</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#duality-theory">4. Duality Theory</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Intuitive Explanation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">The F1 Connection</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-duality-theorems">Key Duality Theorems</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deep-dive-why-duality-matters-in-ml">Deep Dive: Why Duality Matters in ML</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">Key Insight</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#convex-optimization">5. Convex Optimization</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">Intuitive Explanation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">The F1 Connection</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#why-convexity-matters">Why Convexity Matters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deep-dive-common-convex-functions-in-ml">Deep Dive: Common Convex Functions in ML</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">Key Insight</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#constrained-optimization-lagrange-multipliers">6. Constrained Optimization &amp; Lagrange Multipliers</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">Intuitive Explanation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">The F1 Connection</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#kkt-conditions-the-full-picture">KKT Conditions: The Full Picture</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deep-dive-complementary-slackness-the-either-or-rule">Deep Dive: Complementary Slackness — The Either/Or Rule</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#connection-to-machine-learning">7. Connection to Machine Learning</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ml-as-optimization">ML as Optimization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#why-this-matters-in-machine-learning">Why This Matters in Machine Learning</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1-formulate-and-solve-a-race-strategy-lp">Exercise 1: Formulate and Solve a Race Strategy LP</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2-verify-convexity">Exercise 2: Verify Convexity</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3-lagrange-multipliers-by-hand-with-verification">Exercise 3: Lagrange Multipliers by Hand (with Verification)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4-car-setup-landscape-explorer">Exercise 4: Car Setup Landscape Explorer</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-concepts">Key Concepts</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">Connection to Machine Learning</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#checklist">Checklist</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#next-steps">Next Steps</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="part-3-2-optimization-linear-programming">
<h1>Part 3.2: Optimization &amp; Linear Programming<a class="headerlink" href="#part-3-2-optimization-linear-programming" title="Link to this heading">#</a></h1>
<p>Every machine learning algorithm is, at its core, an optimization problem. When we train a neural network, we are searching for the set of weights that minimizes a loss function. When we fit a support vector machine, we are solving a constrained quadratic program. When we tune hyperparameters, we are optimizing a noisy black-box function.</p>
<p>But here is the thing: <strong>F1 teams were doing optimization long before it was cool in ML</strong>. Every race weekend, teams solve dozens of optimization problems — how much fuel to load, when to pit, which tire compound to fit, how to set the suspension, how to split the budget across development areas. All of it subject to strict FIA regulations (constraints) with the goal of minimizing race time (the objective function).</p>
<p>Understanding optimization gives you the vocabulary and intuition to answer questions like:</p>
<ul class="simple">
<li><p><em>Why does gradient descent work?</em> (Because loss functions are often convex, or at least locally convex.)</p></li>
<li><p><em>Why does regularization help?</em> (It adds a constraint to the optimization, shrinking the feasible region.)</p></li>
<li><p><em>Why do SVMs find the “best” boundary?</em> (They solve a convex optimization problem with a unique global solution.)</p></li>
<li><p><em>Why does an F1 strategist pick lap 22 for the pit stop instead of lap 18?</em> (Because it sits at the optimal vertex of their strategy polytope.)</p></li>
</ul>
<p>This notebook builds the mathematical foundation you need before diving into gradient-based methods in the next notebook.</p>
<section id="learning-objectives">
<h2>Learning Objectives<a class="headerlink" href="#learning-objectives" title="Link to this heading">#</a></h2>
<p>By the end of this notebook, you should be able to:</p>
<ul class="simple">
<li><p>[ ] Define an optimization problem (objective, constraints, feasible region)</p></li>
<li><p>[ ] Formulate and solve linear programs graphically and with <code class="docutils literal notranslate"><span class="pre">scipy</span></code></p></li>
<li><p>[ ] Explain the Simplex method at a conceptual level</p></li>
<li><p>[ ] State weak and strong duality and explain their significance</p></li>
<li><p>[ ] Distinguish convex from non-convex problems and explain why convexity matters</p></li>
<li><p>[ ] Apply Lagrange multipliers to equality-constrained problems</p></li>
<li><p>[ ] State the KKT conditions and explain their role in inequality constraints</p></li>
<li><p>[ ] Recognize ML algorithms as optimization problems (SVM, regularized regression)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">linprog</span><span class="p">,</span> <span class="n">minimize</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.patches</span><span class="w"> </span><span class="kn">import</span> <span class="n">Polygon</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.colors</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearSegmentedColormap</span>

<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;seaborn-v0_8-whitegrid&#39;</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="what-is-optimization">
<h2>1. What is Optimization?<a class="headerlink" href="#what-is-optimization" title="Link to this heading">#</a></h2>
<section id="intuitive-explanation">
<h3>Intuitive Explanation<a class="headerlink" href="#intuitive-explanation" title="Link to this heading">#</a></h3>
<p>Optimization is the art and science of finding the <strong>best</strong> solution from a set of possible solutions. In everyday life, you optimize constantly:</p>
<ul class="simple">
<li><p>Choosing the fastest route to work (minimize travel time)</p></li>
<li><p>Allocating a budget across expenses (maximize value subject to spending limits)</p></li>
<li><p>Setting a thermostat (minimize energy use while staying comfortable)</p></li>
</ul>
</section>
<section id="the-f1-connection">
<h3>The F1 Connection<a class="headerlink" href="#the-f1-connection" title="Link to this heading">#</a></h3>
<p>An F1 strategist faces optimization problems every single session. Should we run the medium or hard compound in the second stint? How much fuel do we load for qualifying? What rear wing angle balances top speed against cornering downforce? Every decision is a trade-off, every regulation is a constraint, and the clock is always the objective function.</p>
<p>In mathematics, an optimization problem has three parts:</p>
<ol class="arabic simple">
<li><p><strong>Objective function</strong> <span class="math notranslate nohighlight">\(f(x)\)</span>: The quantity we want to minimize (or maximize) — in F1, this is race time or total points scored</p></li>
<li><p><strong>Decision variables</strong> <span class="math notranslate nohighlight">\(x\)</span>: The knobs we can turn — pit stop laps, fuel load, tire compound selection, wing angle</p></li>
<li><p><strong>Constraints</strong>: Rules that limit which values of <span class="math notranslate nohighlight">\(x\)</span> are allowed — FIA regulations like fuel flow limits, minimum weight, tire allocations, budget cap</p></li>
</ol>
<p>The general form is:</p>
<div class="math notranslate nohighlight">
\[\min_{x} f(x) \quad \text{subject to} \quad g_i(x) \leq 0, \quad h_j(x) = 0\]</div>
<p>The set of all <span class="math notranslate nohighlight">\(x\)</span> that satisfy the constraints is called the <strong>feasible region</strong> — every legal strategy combination. The best point within the feasible region is the <strong>optimal solution</strong> — the strategy the team actually runs.</p>
<p><strong>What this means:</strong> Think of the objective function as a landscape of hills and valleys. The constraints fence off a region you are allowed to explore. Your job is to find the lowest valley (for minimization) inside the fence. In F1 terms, the landscape is “race time as a function of all setup and strategy variables,” the fence is “FIA regulations,” and the lowest valley is “the fastest legal strategy.”</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize a simple 2D optimization landscape</span>
<span class="c1"># F1 analogy: finding the optimal car setup (wing angle vs ride height)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">setup_performance</span><span class="p">(</span><span class="n">wing_angle</span><span class="p">,</span> <span class="n">ride_height</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Lap time penalty as a function of setup: f(wing, ride) = (wing - 2)^2 + (ride - 1)^2&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">wing_angle</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">ride_height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>

<span class="n">wing_angle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
<span class="n">ride_height</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
<span class="n">WING</span><span class="p">,</span> <span class="n">RIDE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">wing_angle</span><span class="p">,</span> <span class="n">ride_height</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">setup_performance</span><span class="p">(</span><span class="n">WING</span><span class="p">,</span> <span class="n">RIDE</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># Left: contour plot — unconstrained setup optimization</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">contour</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">WING</span><span class="p">,</span> <span class="n">RIDE</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues_r&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">WING</span><span class="p">,</span> <span class="n">RIDE</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;navy&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;r*&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Optimal setup (2, 1)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">contour</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Lap time penalty f(wing, ride)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wing Angle Setting&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Ride Height Setting&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Unconstrained Setup Optimization&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Right: same landscape with FIA regulation constraints</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">contour</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">WING</span><span class="p">,</span> <span class="n">RIDE</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues_r&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">WING</span><span class="p">,</span> <span class="n">RIDE</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;navy&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># Constraint: wing + ride &lt;= 2 (regulatory floor/aero limit) and both &gt;= 0</span>
<span class="n">feasible_vertices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="n">feasible_region</span> <span class="o">=</span> <span class="n">Polygon</span><span class="p">(</span><span class="n">feasible_vertices</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Regulation-compliant region&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">feasible_region</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># The constrained optimum is at (1, 1) — closest feasible point to (2,1)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;r*&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Unconstrained optimum&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;r^&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Regulation-constrained optimum (1, 1)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">contour</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Lap time penalty f(wing, ride)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wing Angle Setting&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Ride Height Setting&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Constrained Setup Optimization (FIA Regs)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Left: Without regulations, the optimal setup is at (2, 1) where penalty = 0.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Right: With the regulation wing + ride &lt;= 2 (and both &gt;= 0),&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;       the optimum shifts to (1, 1) on the regulation boundary, where penalty = 1.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;       This is exactly what happens when FIA floor rules force teams off their ideal setup.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/e2178e3159960c8bc123f497733641b6b7d4c0f052bfce12cffe4bf3ec2e51aa.png" src="../_images/e2178e3159960c8bc123f497733641b6b7d4c0f052bfce12cffe4bf3ec2e51aa.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Left: Without regulations, the optimal setup is at (2, 1) where penalty = 0.
Right: With the regulation wing + ride &lt;= 2 (and both &gt;= 0),
       the optimum shifts to (1, 1) on the regulation boundary, where penalty = 1.
       This is exactly what happens when FIA floor rules force teams off their ideal setup.
</pre></div>
</div>
</div>
</div>
</section>
<section id="deep-dive-types-of-optimization-problems">
<h3>Deep Dive: Types of Optimization Problems<a class="headerlink" href="#deep-dive-types-of-optimization-problems" title="Link to this heading">#</a></h3>
<p>Optimization problems are classified by the nature of their objective and constraints:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Type</p></th>
<th class="head"><p>Objective</p></th>
<th class="head"><p>Constraints</p></th>
<th class="head"><p>Example in ML</p></th>
<th class="head"><p>F1 Parallel</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Linear Programming (LP)</strong></p></td>
<td><p>Linear</p></td>
<td><p>Linear inequalities/equalities</p></td>
<td><p>Resource allocation, network flow</p></td>
<td><p>Fuel/tire strategy under FIA regs</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Quadratic Programming (QP)</strong></p></td>
<td><p>Quadratic</p></td>
<td><p>Linear</p></td>
<td><p>SVM (dual form), ridge regression</p></td>
<td><p>Aero balance optimization</p></td>
</tr>
<tr class="row-even"><td><p><strong>Convex Optimization</strong></p></td>
<td><p>Convex</p></td>
<td><p>Convex set</p></td>
<td><p>Logistic regression, LASSO</p></td>
<td><p>Car setup tuning (smooth landscape)</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Non-convex Optimization</strong></p></td>
<td><p>Non-convex</p></td>
<td><p>Any</p></td>
<td><p>Neural network training</p></td>
<td><p>Full car design (aero + engine + chassis)</p></td>
</tr>
<tr class="row-even"><td><p><strong>Integer Programming</strong></p></td>
<td><p>Linear/Quadratic</p></td>
<td><p>Integer variables</p></td>
<td><p>Feature selection</p></td>
<td><p>Number of pit stops (1, 2, or 3)</p></td>
</tr>
</tbody>
</table>
</div>
<section id="key-insight">
<h4>Key Insight<a class="headerlink" href="#key-insight" title="Link to this heading">#</a></h4>
<p>The difficulty of an optimization problem depends on its <strong>structure</strong>, not its size. A convex problem with a million variables is easier (in principle) than a non-convex problem with ten variables. This is why understanding convexity matters so much in ML — and why F1 engineers decompose the car design problem into simpler convex sub-problems whenever they can.</p>
</section>
</section>
</section>
<hr class="docutils" />
<section id="linear-programming">
<h2>2. Linear Programming<a class="headerlink" href="#linear-programming" title="Link to this heading">#</a></h2>
<section id="id1">
<h3>Intuitive Explanation<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<p>A <strong>linear program (LP)</strong> is the simplest type of optimization problem: both the objective function and all constraints are linear.</p>
<p><strong>Standard form:</strong></p>
<div class="math notranslate nohighlight">
\[\min_{x} \mathbf{c}^T \mathbf{x} \quad \text{subject to} \quad A\mathbf{x} \leq \mathbf{b}, \quad \mathbf{x} \geq 0\]</div>
<section id="breaking-down-the-formula">
<h4>Breaking down the formula:<a class="headerlink" href="#breaking-down-the-formula" title="Link to this heading">#</a></h4>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Component</p></th>
<th class="head"><p>Meaning</p></th>
<th class="head"><p>Role</p></th>
<th class="head"><p>F1 Parallel</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\mathbf{c}^T \mathbf{x}\)</span></p></td>
<td><p>Dot product of cost vector and decision variables</p></td>
<td><p>Objective to minimize</p></td>
<td><p>Race time as a function of strategy choices</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(A\mathbf{x} \leq \mathbf{b}\)</span></p></td>
<td><p>Matrix inequality</p></td>
<td><p>Constraint on resources</p></td>
<td><p>FIA regulations (fuel flow, weight, budget)</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\mathbf{x} \geq 0\)</span></p></td>
<td><p>Non-negativity</p></td>
<td><p>Variables must be non-negative</p></td>
<td><p>Can’t have negative fuel or negative pit stops</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="id2">
<h3>The F1 Connection<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<p>Imagine you are an F1 race strategist deciding how to allocate two limited resources — <strong>tire sets</strong> and <strong>pit crew time</strong> — across stint planning. Each strategy option gives a different time advantage (the objective). Each strategy uses different amounts of your limited resources (the constraints). How do you plan the race to minimize total time?</p>
</section>
<section id="geometric-intuition">
<h3>Geometric Intuition<a class="headerlink" href="#geometric-intuition" title="Link to this heading">#</a></h3>
<p>The feasible region of an LP is always a <strong>convex polytope</strong> (a polygon in 2D, a polyhedron in 3D, etc.). The objective function creates parallel hyperplanes across the space. The optimal solution always occurs at a <strong>vertex</strong> of the polytope.</p>
<p>Why a vertex? Because a linear function over a convex region achieves its extreme values at the boundary, and specifically at a corner point. In F1 terms, the best strategy is always at a “corner” of the regulation space — you are always pushing against at least one regulation limit.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example LP: F1 Race Strategy Optimization</span>
<span class="c1"># A team must decide how many laps to run on soft tires (x1) vs medium tires (x2)</span>
<span class="c1"># Maximize: 5*x1 + 4*x2 (time advantage in seconds — softs are faster per lap)</span>
<span class="c1"># Subject to:</span>
<span class="c1">#   6*x1 + 4*x2 &lt;= 24  (tire degradation budget — softs degrade faster)</span>
<span class="c1">#   x1 + 2*x2 &lt;= 6     (available tire sets)</span>
<span class="c1">#   x1, x2 &gt;= 0</span>

<span class="c1"># Graphical solution</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>

<span class="c1"># Constraint boundaries</span>
<span class="n">y1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">24</span> <span class="o">-</span> <span class="mi">6</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="mi">4</span>   <span class="c1"># 6x1 + 4x2 = 24 (degradation budget)</span>
<span class="n">y2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">6</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>       <span class="c1"># x1 + 2x2 = 6 (tire set limit)</span>

<span class="c1"># Plot constraints</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;6x₁ + 4x₂ ≤ 24 (degradation budget)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;x₁ + 2x₂ ≤ 6 (tire set limit)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

<span class="c1"># Feasible region vertices (found by solving intersection equations)</span>
<span class="n">vertices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>    <span class="c1"># x1=4, x2=0: max soft stint, no mediums</span>
    <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span>  <span class="c1"># intersection of both constraints</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>    <span class="c1"># x1=0, x2=3: all mediums</span>
<span class="p">])</span>

<span class="c1"># Fill feasible region</span>
<span class="n">feasible</span> <span class="o">=</span> <span class="n">Polygon</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Legal strategy space&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">feasible</span><span class="p">)</span>

<span class="c1"># Mark vertices</span>
<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vertices</span><span class="p">:</span>
    <span class="n">time_advantage</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;ko&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;(</span><span class="si">{</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">)</span><span class="se">\n</span><span class="s1">Advantage = </span><span class="si">{</span><span class="n">time_advantage</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">s&#39;</span><span class="p">,</span>
                <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mf">0.2</span><span class="p">),</span>
                <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="c1"># Optimal vertex</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="s1">&#39;r*&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Optimal: (3, 1.5), Advantage = 21s&#39;</span><span class="p">)</span>

<span class="c1"># Objective function contours (iso-advantage lines)</span>
<span class="k">for</span> <span class="n">advantage_level</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">21</span><span class="p">]:</span>
    <span class="n">y_obj</span> <span class="o">=</span> <span class="p">(</span><span class="n">advantage_level</span> <span class="o">-</span> <span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="mi">4</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_obj</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y_obj</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">))</span>
    <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">x</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">4.5</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">y_obj</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Advantage=</span><span class="si">{</span><span class="n">advantage_level</span><span class="si">}</span><span class="s1">s&#39;</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x₁ (Soft tire stint length)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;x₂ (Medium tire stint length)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Race Strategy Optimization: Graphical LP Solution&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The optimal strategy is at vertex (3, 1.5) with a time advantage of 21 seconds.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Notice: the optimum is at a vertex of the feasible polytope — this always&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;happens for linear programs. The best race strategy pushes against regulation limits.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/l3/qp293kmd0ps5v659jn3njrpc0000gn/T/ipykernel_5834/393201854.py:64: UserWarning: Glyph 8321 (\N{SUBSCRIPT ONE}) missing from font(s) Arial.
  plt.tight_layout()
/var/folders/l3/qp293kmd0ps5v659jn3njrpc0000gn/T/ipykernel_5834/393201854.py:64: UserWarning: Glyph 8322 (\N{SUBSCRIPT TWO}) missing from font(s) Arial.
  plt.tight_layout()
/Users/danshah/claude_projects/learning/venv/lib/python3.13/site-packages/IPython/core/pylabtools.py:170: UserWarning: Glyph 8322 (\N{SUBSCRIPT TWO}) missing from font(s) Arial.
  fig.canvas.print_figure(bytes_io, **kw)
/Users/danshah/claude_projects/learning/venv/lib/python3.13/site-packages/IPython/core/pylabtools.py:170: UserWarning: Glyph 8321 (\N{SUBSCRIPT ONE}) missing from font(s) Arial.
  fig.canvas.print_figure(bytes_io, **kw)
</pre></div>
</div>
<img alt="../_images/befd9c60ac0aee3677fb251a4edf99a5bafebc2eb4db87ceb4fa478e2fa07415.png" src="../_images/befd9c60ac0aee3677fb251a4edf99a5bafebc2eb4db87ceb4fa478e2fa07415.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The optimal strategy is at vertex (3, 1.5) with a time advantage of 21 seconds.
Notice: the optimum is at a vertex of the feasible polytope — this always
happens for linear programs. The best race strategy pushes against regulation limits.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solving the same race strategy LP with scipy.optimize.linprog</span>
<span class="c1"># Note: linprog MINIMIZES, so we negate the objective for maximization</span>

<span class="c1"># Maximize 5*x1 + 4*x2 (time advantage) -&gt; Minimize -5*x1 - 4*x2</span>
<span class="n">race_objective</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">]</span>  <span class="c1"># negated for minimization</span>

<span class="c1"># Inequality constraints: A_ub @ x &lt;= b_ub</span>
<span class="c1"># Degradation budget + tire set limit</span>
<span class="n">A_regulations</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>   <span class="c1"># 6x1 + 4x2 &lt;= 24 (degradation budget)</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>   <span class="c1"># x1 + 2x2 &lt;= 6 (tire sets available)</span>
<span class="p">]</span>
<span class="n">b_regulations</span> <span class="o">=</span> <span class="p">[</span><span class="mi">24</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>

<span class="c1"># Bounds: soft_stints &gt;= 0, medium_stints &gt;= 0</span>
<span class="n">soft_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">medium_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">linprog</span><span class="p">(</span><span class="n">race_objective</span><span class="p">,</span> <span class="n">A_ub</span><span class="o">=</span><span class="n">A_regulations</span><span class="p">,</span> <span class="n">b_ub</span><span class="o">=</span><span class="n">b_regulations</span><span class="p">,</span>
                 <span class="n">bounds</span><span class="o">=</span><span class="p">[</span><span class="n">soft_bounds</span><span class="p">,</span> <span class="n">medium_bounds</span><span class="p">],</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;highs&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== Race Strategy LP Solution (scipy.optimize.linprog) ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Optimal soft tire stint:   </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Optimal medium tire stint: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Maximum time advantage:    </span><span class="si">{</span><span class="o">-</span><span class="n">result</span><span class="o">.</span><span class="n">fun</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>  <span class="c1"># negate back</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Solver status: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">message</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== Race Strategy LP Solution (scipy.optimize.linprog) ===
Optimal soft tire stint:   3.0000
Optimal medium tire stint: 1.5000
Maximum time advantage:    21.0000 seconds
Solver status: Optimization terminated successfully. (HiGHS Status 7: Optimal)
</pre></div>
</div>
</div>
</div>
</section>
<section id="deep-dive-why-lps-always-have-vertex-solutions">
<h3>Deep Dive: Why LPs Always Have Vertex Solutions<a class="headerlink" href="#deep-dive-why-lps-always-have-vertex-solutions" title="Link to this heading">#</a></h3>
<p>A linear objective function <span class="math notranslate nohighlight">\(\mathbf{c}^T \mathbf{x}\)</span> defines a family of parallel hyperplanes (lines in 2D). As we slide these hyperplanes in the direction of improvement, the last point of contact with the feasible polytope must be a vertex (or an edge/face, in degenerate cases where the objective is parallel to a constraint).</p>
<p>This geometric fact is the foundation of the Simplex method: instead of searching the entire feasible region, we only need to check vertices.</p>
<p><strong>F1 analogy:</strong> Think of it this way — the optimal pit strategy always involves pushing at least one constraint to its limit. You are either using all your available tire sets, or maxing out the degradation budget, or both. You are never leaving resources unused while also not being at the fastest strategy. The “vertex” is the strategy where you are right at the edge of the regulations.</p>
<section id="common-misconceptions">
<h4>Common Misconceptions<a class="headerlink" href="#common-misconceptions" title="Link to this heading">#</a></h4>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Misconception</p></th>
<th class="head"><p>Reality</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>LP solutions can be interior points</p></td>
<td><p>The optimum is always on the boundary (at a vertex or edge)</p></td>
</tr>
<tr class="row-odd"><td><p>More constraints make the problem harder</p></td>
<td><p>More constraints reduce the feasible region, often making the search easier</p></td>
</tr>
<tr class="row-even"><td><p>LP can only handle simple problems</p></td>
<td><p>LP underlies many sophisticated algorithms (network flows, assignment problems)</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
</section>
<hr class="docutils" />
<section id="the-simplex-method">
<h2>3. The Simplex Method<a class="headerlink" href="#the-simplex-method" title="Link to this heading">#</a></h2>
<section id="id3">
<h3>Intuitive Explanation<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<p>The <strong>Simplex method</strong> (George Dantzig, 1947) is the classic algorithm for solving linear programs. Its strategy is elegantly simple:</p>
<ol class="arabic simple">
<li><p><strong>Start</strong> at any vertex of the feasible polytope</p></li>
<li><p><strong>Look</strong> at all neighboring vertices (connected by an edge)</p></li>
<li><p><strong>Move</strong> to the neighbor that improves the objective the most</p></li>
<li><p><strong>Repeat</strong> until no neighbor is better — you are at the optimum</p></li>
</ol>
</section>
<section id="id4">
<h3>The F1 Connection<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<p>Think of this as an F1 strategist exploring discrete strategy options. You start with a baseline strategy (say, pit on lap 1 with hards). You look at neighboring strategies — pit on lap 5 instead, or switch to mediums. You move to whichever adjacent strategy is fastest. When no neighboring tweak improves race time, you have found the optimal strategy.</p>
<p><strong>What this means:</strong> Imagine standing on one corner of a diamond. You look along each edge and walk to whichever adjacent corner is downhill. When every direction is uphill, you have found the lowest corner.</p>
<p>In theory, the Simplex method could visit exponentially many vertices. In practice, it is remarkably fast — typically visiting <span class="math notranslate nohighlight">\(O(m)\)</span> vertices where <span class="math notranslate nohighlight">\(m\)</span> is the number of constraints. Just like an F1 strategist does not need to evaluate every possible lap combination — a few smart pivots get you to the winning strategy.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize the Simplex method: strategy vertex hopping</span>
<span class="c1"># Trace the path the Simplex method takes on our race strategy LP</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
<span class="n">y1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">24</span> <span class="o">-</span> <span class="mi">6</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="mi">4</span>
<span class="n">y2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">6</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>

<span class="c1"># Feasible region (legal strategy space)</span>
<span class="n">vertices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
<span class="n">feasible</span> <span class="o">=</span> <span class="n">Polygon</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">feasible</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">y2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># Simplex path: start at &quot;do nothing&quot; strategy, hop along vertices</span>
<span class="n">simplex_path</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>     <span class="c1"># Step 0: start at baseline (no tire advantage)</span>
    <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>     <span class="c1"># Step 1: go all-in on softs (biggest per-lap gain)</span>
    <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span>   <span class="c1"># Step 2: trade some soft laps for medium laps (still improving)</span>
<span class="p">]</span>

<span class="n">colors_path</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Start: (0,0)</span><span class="se">\n</span><span class="s1">Advantage=0s&#39;</span><span class="p">,</span> <span class="s1">&#39;Step 1: (4,0)</span><span class="se">\n</span><span class="s1">Advantage=20s&#39;</span><span class="p">,</span> <span class="s1">&#39;Optimal: (3,1.5)</span><span class="se">\n</span><span class="s1">Advantage=21s&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">simplex_path</span><span class="p">,</span> <span class="n">colors_path</span><span class="p">,</span> <span class="n">labels</span><span class="p">)):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">offset</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)][</span><span class="n">i</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="n">point</span><span class="p">,</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">offset</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">offset</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
                <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">))</span>

<span class="c1"># Draw path arrows</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">simplex_path</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">simplex_path</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">end</span> <span class="o">=</span> <span class="n">simplex_path</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="n">end</span><span class="p">,</span> <span class="n">xytext</span><span class="o">=</span><span class="n">start</span><span class="p">,</span>
                <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkgreen&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span>
                                <span class="n">connectionstyle</span><span class="o">=</span><span class="s1">&#39;arc3,rad=0.1&#39;</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x₁ (Soft tire stint)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;x₂ (Medium tire stint)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Simplex Method: Strategy Vertex Hopping&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The Simplex method visits only 3 of 4 strategy vertices to find the optimum.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;It never explores the interior — only vertices and edges.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Like an F1 strategist: you don&#39;t test every possible lap plan,&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;you iteratively tweak the best plan until no tweak helps.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/l3/qp293kmd0ps5v659jn3njrpc0000gn/T/ipykernel_5834/1992167517.py:49: UserWarning: Glyph 8321 (\N{SUBSCRIPT ONE}) missing from font(s) Arial.
  plt.tight_layout()
/var/folders/l3/qp293kmd0ps5v659jn3njrpc0000gn/T/ipykernel_5834/1992167517.py:49: UserWarning: Glyph 8322 (\N{SUBSCRIPT TWO}) missing from font(s) Arial.
  plt.tight_layout()
</pre></div>
</div>
<img alt="../_images/3a91b3383e8a3c27ced8294074b1f46f440b47b022120a4a77c0a8baffde1441.png" src="../_images/3a91b3383e8a3c27ced8294074b1f46f440b47b022120a4a77c0a8baffde1441.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The Simplex method visits only 3 of 4 strategy vertices to find the optimum.
It never explores the interior — only vertices and edges.
Like an F1 strategist: you don&#39;t test every possible lap plan,
you iteratively tweak the best plan until no tweak helps.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">simplex_2d</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">A_ub</span><span class="p">,</span> <span class="n">b_ub</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A simplified 2D Simplex implementation for educational purposes.</span>
<span class="sd">    Finds all vertices of the feasible polytope and evaluates the objective.</span>
<span class="sd">    </span>
<span class="sd">    This is NOT a full Simplex implementation — it is a brute-force vertex</span>
<span class="sd">    enumeration to illustrate the concept. Think of it as a strategist</span>
<span class="sd">    exhaustively checking every discrete strategy option.</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        c: Objective coefficients [c1, c2] (minimize c^T x)</span>
<span class="sd">        A_ub: Inequality constraint matrix (A_ub @ x &lt;= b_ub)</span>
<span class="sd">        b_ub: Right-hand side of inequalities</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        Tuple of (optimal_vertex, optimal_value, all_vertices)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">itertools</span><span class="w"> </span><span class="kn">import</span> <span class="n">combinations</span>
    
    <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">A_ub</span><span class="p">)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">b_ub</span><span class="p">)</span>
    
    <span class="c1"># Add non-negativity constraints: -x1 &lt;= 0, -x2 &lt;= 0</span>
    <span class="n">A_full</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">A</span><span class="p">,</span> <span class="p">[[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]]])</span>
    <span class="n">b_full</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">b</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
    
    <span class="n">n_constraints</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">A_full</span><span class="p">)</span>
    <span class="n">vertices</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="c1"># Find all intersections of pairs of constraint lines</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n_constraints</span><span class="p">),</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">A_pair</span> <span class="o">=</span> <span class="n">A_full</span><span class="p">[[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]]</span>
        <span class="n">b_pair</span> <span class="o">=</span> <span class="n">b_full</span><span class="p">[[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">vertex</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A_pair</span><span class="p">,</span> <span class="n">b_pair</span><span class="p">)</span>
            <span class="c1"># Check if this vertex satisfies ALL constraints (regulations)</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">A_full</span> <span class="o">@</span> <span class="n">vertex</span> <span class="o">&lt;=</span> <span class="n">b_full</span> <span class="o">+</span> <span class="mf">1e-10</span><span class="p">):</span>
                <span class="n">vertices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vertex</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">LinAlgError</span><span class="p">:</span>
            <span class="k">continue</span>  <span class="c1"># Parallel constraints, no intersection</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">vertices</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">[]</span>
    
    <span class="n">vertices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span>
    <span class="c1"># Remove duplicates</span>
    <span class="n">unique</span> <span class="o">=</span> <span class="p">[</span><span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vertices</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">unique</span><span class="p">):</span>
            <span class="n">unique</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
    <span class="n">vertices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">unique</span><span class="p">)</span>
    
    <span class="c1"># Evaluate objective at each vertex (each candidate strategy)</span>
    <span class="n">obj_values</span> <span class="o">=</span> <span class="n">vertices</span> <span class="o">@</span> <span class="n">c</span>
    <span class="n">best_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">obj_values</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">vertices</span><span class="p">[</span><span class="n">best_idx</span><span class="p">],</span> <span class="n">obj_values</span><span class="p">[</span><span class="n">best_idx</span><span class="p">],</span> <span class="n">vertices</span>


<span class="c1"># Test on our race strategy problem (minimize -5x1 - 4x2)</span>
<span class="n">opt_vertex</span><span class="p">,</span> <span class="n">opt_value</span><span class="p">,</span> <span class="n">all_vertices</span> <span class="o">=</span> <span class="n">simplex_2d</span><span class="p">(</span>
    <span class="n">c</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">],</span>
    <span class="n">A_ub</span><span class="o">=</span><span class="p">[[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]],</span>
    <span class="n">b_ub</span><span class="o">=</span><span class="p">[</span><span class="mi">24</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== Simplified Simplex (Strategy Vertex Enumeration) ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">All legal strategy vertices:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">all_vertices</span><span class="p">:</span>
    <span class="n">advantage</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Soft=</span><span class="si">{</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, Medium=</span><span class="si">{</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> -&gt; Time advantage = </span><span class="si">{</span><span class="n">advantage</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Optimal strategy: Soft=</span><span class="si">{</span><span class="n">opt_vertex</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, Medium=</span><span class="si">{</span><span class="n">opt_vertex</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Maximum time advantage: </span><span class="si">{</span><span class="o">-</span><span class="n">opt_value</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== Simplified Simplex (Strategy Vertex Enumeration) ===

All legal strategy vertices:
  Soft=3.00, Medium=1.50 -&gt; Time advantage = 21.00s
  Soft=4.00, Medium=-0.00 -&gt; Time advantage = 20.00s
  Soft=0.00, Medium=3.00 -&gt; Time advantage = 12.00s
  Soft=-0.00, Medium=-0.00 -&gt; Time advantage = -0.00s

Optimal strategy: Soft=3.00, Medium=1.50
Maximum time advantage: 21.00s
</pre></div>
</div>
</div>
</div>
</section>
<section id="deep-dive-simplex-vs-interior-point-methods">
<h3>Deep Dive: Simplex vs Interior Point Methods<a class="headerlink" href="#deep-dive-simplex-vs-interior-point-methods" title="Link to this heading">#</a></h3>
<p>The Simplex method walks along edges of the polytope. An alternative family of algorithms — <strong>interior point methods</strong> — takes a very different approach: they walk <em>through the interior</em> of the polytope, approaching the optimal vertex from inside.</p>
<p><strong>F1 analogy:</strong> The Simplex method is like trying different discrete strategies: “pit on lap 12, no — lap 15, no — lap 18.” Interior point methods are more like continuously refining a strategy simulation, starting with a rough average plan and homing in on the optimal one.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Property</p></th>
<th class="head"><p>Simplex</p></th>
<th class="head"><p>Interior Point</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Path</p></td>
<td><p>Along edges (vertex to vertex)</p></td>
<td><p>Through the interior</p></td>
</tr>
<tr class="row-odd"><td><p>Worst case</p></td>
<td><p>Exponential</p></td>
<td><p>Polynomial</p></td>
</tr>
<tr class="row-even"><td><p>Practical speed</p></td>
<td><p>Very fast for most LPs</p></td>
<td><p>Slightly slower on small LPs, faster on huge ones</p></td>
</tr>
<tr class="row-odd"><td><p>Solution type</p></td>
<td><p>Exact vertex solution</p></td>
<td><p>Approaches vertex asymptotically</p></td>
</tr>
<tr class="row-even"><td><p>Used in <code class="docutils literal notranslate"><span class="pre">scipy</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">method='revised</span> <span class="pre">simplex'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">method='highs'</span></code> (default, hybrid)</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>What this means for ML:</strong> Most modern LP/QP solvers (like those inside SVM implementations) use interior point methods because they have reliable polynomial-time guarantees.</p>
</section>
</section>
<hr class="docutils" />
<section id="duality-theory">
<h2>4. Duality Theory<a class="headerlink" href="#duality-theory" title="Link to this heading">#</a></h2>
<section id="id5">
<h3>Intuitive Explanation<a class="headerlink" href="#id5" title="Link to this heading">#</a></h3>
<p>Every linear program (the <strong>primal</strong>) has a companion problem called the <strong>dual</strong>. If the primal asks “What is the minimum cost to meet these requirements?”, the dual asks “What is the maximum value of the resources?”</p>
</section>
<section id="id6">
<h3>The F1 Connection<a class="headerlink" href="#id6" title="Link to this heading">#</a></h3>
<p>Duality shows up naturally in F1. Consider a team allocating resources between two drivers:</p>
<ul class="simple">
<li><p><strong>Team principal’s view (primal):</strong> “What is the minimum total budget to give both drivers competitive cars?”</p></li>
<li><p><strong>Driver’s view (dual):</strong> “What is the maximum performance value of the budget I have been allocated?”</p></li>
</ul>
<p>Both perspectives describe the same underlying resource allocation problem, just from different sides of the pit wall.</p>
<p><strong>Primal (minimize):</strong>
$<span class="math notranslate nohighlight">\(\min_{x} \mathbf{c}^T \mathbf{x} \quad \text{s.t.} \quad A\mathbf{x} \geq \mathbf{b}, \; \mathbf{x} \geq 0\)</span>$</p>
<p><strong>Dual (maximize):</strong>
$<span class="math notranslate nohighlight">\(\max_{y} \mathbf{b}^T \mathbf{y} \quad \text{s.t.} \quad A^T\mathbf{y} \leq \mathbf{c}, \; \mathbf{y} \geq 0\)</span>$</p>
<p>The dual variables <span class="math notranslate nohighlight">\(\mathbf{y}\)</span> are sometimes called <strong>shadow prices</strong> — they tell you how much the optimal objective would change if you relaxed a constraint by one unit. In F1: “How much faster would we go if the fuel flow limit increased by 1 kg/hr?” That is the shadow price of the fuel flow regulation.</p>
</section>
<section id="key-duality-theorems">
<h3>Key Duality Theorems<a class="headerlink" href="#key-duality-theorems" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>Weak Duality:</strong> The dual objective is always a lower bound for the primal:
$<span class="math notranslate nohighlight">\(\mathbf{b}^T \mathbf{y} \leq \mathbf{c}^T \mathbf{x} \quad \text{(for all feasible } x, y\text{)}\)</span>$</p></li>
<li><p><strong>Strong Duality:</strong> At optimality, the bounds meet exactly:
$<span class="math notranslate nohighlight">\(\mathbf{b}^T \mathbf{y}^* = \mathbf{c}^T \mathbf{x}^*\)</span>$</p></li>
<li><p><strong>Complementary Slackness:</strong> At optimality, either a constraint is tight (active) or its dual variable is zero. No resource is both unused and valued. In F1: if you have leftover tire sets at the end of the race, those tire sets had zero shadow price — they were not the binding constraint.</p></li>
</ol>
<p><strong>What this means:</strong> Duality gives us two views of the same problem. If we can solve the dual, we automatically get the primal solution (and vice versa). In ML, the SVM dual formulation is actually easier to solve than the primal.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Demonstrate duality with a concrete example</span>
<span class="c1"># F1 framing: minimum-cost resource allocation to meet driver performance targets</span>
<span class="c1"># Primal: min c^T x  s.t. Ax &gt;= b, x &gt;= 0</span>
<span class="c1"># Reformulated as: min c^T x  s.t. -Ax &lt;= -b, x &gt;= 0 (for linprog)</span>

<span class="c1"># Primal problem (team principal&#39;s view):</span>
<span class="c1"># min 4*aero_budget + 3*engine_budget (total spending)</span>
<span class="c1"># s.t.  2*aero + 1*engine &gt;= 8  (Driver 1 performance target)</span>
<span class="c1">#        1*aero + 2*engine &gt;= 6  (Driver 2 performance target)</span>
<span class="c1">#        aero, engine &gt;= 0</span>

<span class="c1"># Primal with linprog (convert &gt;= to &lt;=)</span>
<span class="n">c_primal</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">A_primal</span> <span class="o">=</span> <span class="p">[[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]]</span>  <span class="c1"># negated for &lt;=</span>
<span class="n">b_primal</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">]</span>

<span class="n">result_primal</span> <span class="o">=</span> <span class="n">linprog</span><span class="p">(</span><span class="n">c_primal</span><span class="p">,</span> <span class="n">A_ub</span><span class="o">=</span><span class="n">A_primal</span><span class="p">,</span> <span class="n">b_ub</span><span class="o">=</span><span class="n">b_primal</span><span class="p">,</span>
                        <span class="n">bounds</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)],</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;highs&#39;</span><span class="p">)</span>

<span class="c1"># Dual problem (driver&#39;s view — value of performance targets):</span>
<span class="c1"># max 8*y1 + 6*y2 -&gt; min -8*y1 - 6*y2</span>
<span class="c1"># s.t.  2*y1 + y2 &lt;= 4   (aero value can&#39;t exceed aero cost)</span>
<span class="c1">#        y1 + 2*y2 &lt;= 3   (engine value can&#39;t exceed engine cost)</span>
<span class="c1">#        y1, y2 &gt;= 0</span>

<span class="n">c_dual</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">]</span>  <span class="c1"># negated for minimization</span>
<span class="n">A_dual</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
<span class="n">b_dual</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>

<span class="n">result_dual</span> <span class="o">=</span> <span class="n">linprog</span><span class="p">(</span><span class="n">c_dual</span><span class="p">,</span> <span class="n">A_ub</span><span class="o">=</span><span class="n">A_dual</span><span class="p">,</span> <span class="n">b_ub</span><span class="o">=</span><span class="n">b_dual</span><span class="p">,</span>
                      <span class="n">bounds</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)],</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;highs&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== Primal-Dual Comparison (Team vs Driver View) ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Primal (team) optimal allocation: aero=</span><span class="si">{</span><span class="n">result_primal</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, engine=</span><span class="si">{</span><span class="n">result_primal</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Primal optimal cost: </span><span class="si">{</span><span class="n">result_primal</span><span class="o">.</span><span class="n">fun</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Dual (driver) shadow prices: y1=</span><span class="si">{</span><span class="n">result_dual</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, y2=</span><span class="si">{</span><span class="n">result_dual</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dual optimal value: </span><span class="si">{</span><span class="o">-</span><span class="n">result_dual</span><span class="o">.</span><span class="n">fun</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># negate back</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Strong duality holds: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">result_primal</span><span class="o">.</span><span class="n">fun</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">result_dual</span><span class="o">.</span><span class="n">fun</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Duality gap: </span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="n">result_primal</span><span class="o">.</span><span class="n">fun</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="n">result_dual</span><span class="o">.</span><span class="n">fun</span><span class="p">))</span><span class="si">:</span><span class="s2">.10f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== Primal-Dual Comparison (Team vs Driver View) ===

Primal (team) optimal allocation: aero=3.3333, engine=1.3333
Primal optimal cost: 17.3333

Dual (driver) shadow prices: y1=1.6667, y2=0.6667
Dual optimal value: 17.3333

Strong duality holds: True
Duality gap: 0.0000000000
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize primal and dual feasible regions side by side</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>

<span class="c1"># --- Primal (Team Principal&#39;s View) ---</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># Constraints: 2*aero + engine &gt;= 8, aero + 2*engine &gt;= 6</span>
<span class="n">y_c1</span> <span class="o">=</span> <span class="mi">8</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span>       <span class="c1"># engine &gt;= 8 - 2*aero</span>
<span class="n">y_c2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">6</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>   <span class="c1"># engine &gt;= (6 - aero)/2</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_c1</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;2(aero) + engine = 8&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_c2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;aero + 2(engine) = 6&#39;</span><span class="p">)</span>

<span class="c1"># Fill feasible region (above both lines)</span>
<span class="n">y_lower</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">y_c1</span><span class="p">,</span> <span class="n">y_c2</span><span class="p">)</span>
<span class="n">y_lower</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">y_lower</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_lower</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="p">(</span><span class="n">y_lower</span> <span class="o">&lt;=</span> <span class="mi">10</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">),</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Feasible allocations&#39;</span><span class="p">)</span>

<span class="c1"># Optimal point</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">result_primal</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">result_primal</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;r*&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Optimal: (</span><span class="si">{</span><span class="n">result_primal</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">result_primal</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Aero Budget&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Engine Budget&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Primal: Team View (min cost = </span><span class="si">{</span><span class="n">result_primal</span><span class="o">.</span><span class="n">fun</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># --- Dual (Driver&#39;s View) ---</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="c1"># Constraints: 2y1 + y2 &lt;= 4, y1 + 2y2 &lt;= 3</span>
<span class="n">y_d1</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span>       <span class="c1"># y2 &lt;= 4 - 2y1</span>
<span class="n">y_d2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>   <span class="c1"># y2 &lt;= (3 - y1)/2</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_d1</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;2y₁ + y₂ = 4&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_d2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;y₁ + 2y₂ = 3&#39;</span><span class="p">)</span>

<span class="c1"># Feasible region vertices for dual</span>
<span class="n">dual_verts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">]])</span>
<span class="n">dual_poly</span> <span class="o">=</span> <span class="n">Polygon</span><span class="p">(</span><span class="n">dual_verts</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Feasible valuations&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">dual_poly</span><span class="p">)</span>

<span class="c1"># Optimal point</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">result_dual</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">result_dual</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;r*&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Optimal: (</span><span class="si">{</span><span class="n">result_dual</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">result_dual</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Driver 1 Performance Value (y₁)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Driver 2 Performance Value (y₂)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Dual: Driver View (max value = </span><span class="si">{</span><span class="o">-</span><span class="n">result_dual</span><span class="o">.</span><span class="n">fun</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Strong duality: both problems achieve the same optimal value.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The dual variables (shadow prices) tell us: how much total cost would&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;decrease if we relaxed a driver&#39;s performance target by one unit.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/l3/qp293kmd0ps5v659jn3njrpc0000gn/T/ipykernel_5834/419004724.py:59: UserWarning: Glyph 8321 (\N{SUBSCRIPT ONE}) missing from font(s) Arial.
  plt.tight_layout()
/var/folders/l3/qp293kmd0ps5v659jn3njrpc0000gn/T/ipykernel_5834/419004724.py:59: UserWarning: Glyph 8322 (\N{SUBSCRIPT TWO}) missing from font(s) Arial.
  plt.tight_layout()
</pre></div>
</div>
<img alt="../_images/c615dda2e71df8ff19002b7a89a3a093bef43eea61acd41edeb2b69d445a09a2.png" src="../_images/c615dda2e71df8ff19002b7a89a3a093bef43eea61acd41edeb2b69d445a09a2.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Strong duality: both problems achieve the same optimal value.
The dual variables (shadow prices) tell us: how much total cost would
decrease if we relaxed a driver&#39;s performance target by one unit.
</pre></div>
</div>
</div>
</div>
</section>
<section id="deep-dive-why-duality-matters-in-ml">
<h3>Deep Dive: Why Duality Matters in ML<a class="headerlink" href="#deep-dive-why-duality-matters-in-ml" title="Link to this heading">#</a></h3>
<p>Duality is not just a theoretical curiosity — it is the engine behind several important ML algorithms:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>ML Application</p></th>
<th class="head"><p>How Duality is Used</p></th>
<th class="head"><p>F1 Parallel</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Support Vector Machines</strong></p></td>
<td><p>The SVM primal is hard (minimize over <span class="math notranslate nohighlight">\(w, b\)</span>). The dual is easier and reveals the kernel trick.</p></td>
<td><p>Team vs driver view of the same budget allocation</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Regularization</strong></p></td>
<td><p>Adding an <span class="math notranslate nohighlight">\(\ell_2\)</span> penalty is equivalent to constraining the norm (Lagrangian duality).</p></td>
<td><p>Budget cap = penalty on spending; weight limit = constraint on car mass</p></td>
</tr>
<tr class="row-even"><td><p><strong>Maximum Entropy Models</strong></p></td>
<td><p>The dual of the constrained entropy problem yields logistic regression.</p></td>
<td><p>Maximizing unpredictability within known track constraints</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Variational Inference</strong></p></td>
<td><p>ELBO (Evidence Lower BOund) is a dual bound on the marginal likelihood.</p></td>
<td><p>Lower bound on expected race pace given incomplete data</p></td>
</tr>
</tbody>
</table>
</div>
<section id="id7">
<h4>Key Insight<a class="headerlink" href="#id7" title="Link to this heading">#</a></h4>
<p>The dual often reveals hidden structure. For SVMs, the dual formulation depends only on dot products of data points <span class="math notranslate nohighlight">\(\langle x_i, x_j \rangle\)</span>, which lets us use the <strong>kernel trick</strong> to work in infinite-dimensional feature spaces. Similarly, in F1, looking at the same problem from the regulation side (dual) versus the strategy side (primal) often reveals which constraints actually matter.</p>
</section>
</section>
</section>
<hr class="docutils" />
<section id="convex-optimization">
<h2>5. Convex Optimization<a class="headerlink" href="#convex-optimization" title="Link to this heading">#</a></h2>
<section id="id8">
<h3>Intuitive Explanation<a class="headerlink" href="#id8" title="Link to this heading">#</a></h3>
<p>A set is <strong>convex</strong> if the line segment between any two points in the set lies entirely within the set. Think of a filled circle (convex) versus a crescent moon (not convex).</p>
<p>A function is <strong>convex</strong> if it curves upward — like a bowl. Formally, <span class="math notranslate nohighlight">\(f\)</span> is convex if:</p>
<div class="math notranslate nohighlight">
\[f(\lambda x + (1-\lambda)y) \leq \lambda f(x) + (1-\lambda)f(y) \quad \forall \lambda \in [0,1]\]</div>
<p><strong>What this means:</strong> Draw a line between any two points on the function’s graph. If the function always lies below (or on) the line, it is convex. A bowl has this property; a roller coaster does not.</p>
</section>
<section id="id9">
<h3>The F1 Connection<a class="headerlink" href="#id9" title="Link to this heading">#</a></h3>
<p>Think of <strong>car setup optimization</strong> as a landscape. For many setup parameters (like spring stiffness or anti-roll bar setting), the lap time response is approximately convex — a smooth bowl where the optimal setting sits at the bottom. This is the “sweet spot” engineers talk about. You can find it by gradient descent (adjusting setup incrementally), and you will not get stuck in a false minimum.</p>
<p>But <strong>full car design</strong> — combining aero, engine, suspension, and electronics — is highly non-convex. There are multiple local minima (design philosophies that each work but are very different), and getting stuck in one requires a radical concept change to escape. Red Bull’s 2022 car and Mercedes’ “zero-pod” concept were two very different local minima.</p>
</section>
<section id="why-convexity-matters">
<h3>Why Convexity Matters<a class="headerlink" href="#why-convexity-matters" title="Link to this heading">#</a></h3>
<p><strong>The fundamental theorem of convex optimization:</strong> For a convex function over a convex set, every local minimum is a global minimum.</p>
<p>This means:</p>
<ul class="simple">
<li><p>No getting stuck in local minima</p></li>
<li><p>Gradient descent is guaranteed to find the global optimum</p></li>
<li><p>The solution is unique (for strictly convex functions)</p></li>
</ul>
<p>This is why much of ML theory revolves around convex loss functions (squared error, cross-entropy, hinge loss) and convex regularizers (<span class="math notranslate nohighlight">\(\ell_1\)</span>, <span class="math notranslate nohighlight">\(\ell_2\)</span>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize convex vs non-convex sets and functions</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># --- Top Left: Convex set (smooth oval — like a valid setup parameter region) ---</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="c1"># Ellipse (convex)</span>
<span class="n">cx</span><span class="p">,</span> <span class="n">cy</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">cx</span><span class="p">,</span> <span class="n">cy</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cx</span><span class="p">,</span> <span class="n">cy</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># Show line segment test</span>
<span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p2</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Line segment (inside)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="n">p1</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="n">p2</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Convex Set (Legal Setup Region)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># --- Top Right: Non-convex set (star shape — like a fragmented regulation space) ---</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="c1"># Star shape (non-convex)</span>
<span class="n">angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">radii</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.5</span> <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="mf">0.6</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">11</span><span class="p">)]</span>
<span class="n">sx</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">radii</span><span class="p">,</span> <span class="n">angles</span><span class="p">)]</span>
<span class="n">sy</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">radii</span><span class="p">,</span> <span class="n">angles</span><span class="p">)]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># Show line segment test failing</span>
<span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p2</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Line segment (goes outside!)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="n">p1</span><span class="p">,</span> <span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="n">p2</span><span class="p">,</span> <span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Non-Convex Set (Fragmented Design Space)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># --- Bottom Left: Convex function (single-parameter setup: one sweet spot) ---</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">y_convex</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_convex</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;f(x) = x² (convex — one sweet spot)&#39;</span><span class="p">)</span>
<span class="c1"># Secant line</span>
<span class="n">xa</span><span class="p">,</span> <span class="n">xb</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.5</span>
<span class="n">ya</span><span class="p">,</span> <span class="n">yb</span> <span class="o">=</span> <span class="n">xa</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">xb</span><span class="o">**</span><span class="mi">2</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xa</span><span class="p">,</span> <span class="n">xb</span><span class="p">],</span> <span class="p">[</span><span class="n">ya</span><span class="p">,</span> <span class="n">yb</span><span class="p">],</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Secant line (always above f)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">[(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">xa</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">xb</span><span class="p">)],</span>
                <span class="n">x</span><span class="p">[(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">xa</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">xb</span><span class="p">)]</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span>
                <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">x</span><span class="p">[(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">xa</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">xb</span><span class="p">)],</span> <span class="p">[</span><span class="n">xa</span><span class="p">,</span> <span class="n">xb</span><span class="p">],</span> <span class="p">[</span><span class="n">ya</span><span class="p">,</span> <span class="n">yb</span><span class="p">]),</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;r*&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Global minimum (optimal setting)&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Convex Function (Spring Stiffness vs Lap Time)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Setup parameter&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Lap time penalty&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># --- Bottom Right: Non-convex function (multi-parameter: multiple local minima) ---</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">y_nonconvex</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.3</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_nonconvex</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;f(x) = sin(2x) + 0.3x² (non-convex)&#39;</span><span class="p">)</span>
<span class="c1"># Mark local minima</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.signal</span><span class="w"> </span><span class="kn">import</span> <span class="n">argrelmin</span>
<span class="n">local_mins</span> <span class="o">=</span> <span class="n">argrelmin</span><span class="p">(</span><span class="n">y_nonconvex</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">20</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">for</span> <span class="n">lm</span> <span class="ow">in</span> <span class="n">local_mins</span><span class="p">:</span>
    <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span> <span class="k">if</span> <span class="n">y_nonconvex</span><span class="p">[</span><span class="n">lm</span><span class="p">]</span> <span class="o">==</span> <span class="nb">min</span><span class="p">(</span><span class="n">y_nonconvex</span><span class="p">[</span><span class="n">local_mins</span><span class="p">])</span> <span class="k">else</span> <span class="s1">&#39;orange&#39;</span>
    <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Global min (best design)&#39;</span> <span class="k">if</span> <span class="n">color</span> <span class="o">==</span> <span class="s1">&#39;red&#39;</span> <span class="k">else</span> <span class="s1">&#39;Local min (good but not best)&#39;</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">lm</span><span class="p">],</span> <span class="n">y_nonconvex</span><span class="p">[</span><span class="n">lm</span><span class="p">],</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Non-Convex Function (Full Car Design Landscape)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Design parameter&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Lap time penalty&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Top row: Convex sets pass the line-segment test; non-convex sets fail it.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Bottom row: Convex functions have one minimum; non-convex functions may have many.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">F1 insight: a spring stiffness setting has a smooth optimal (convex).&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Full car design is non-convex — different philosophies can each be local optima.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ac16ad63371aa77ea8792f25a75e81f40cff7fb9d0c1d3d3e1eb5cab87f36e2c.png" src="../_images/ac16ad63371aa77ea8792f25a75e81f40cff7fb9d0c1d3d3e1eb5cab87f36e2c.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Top row: Convex sets pass the line-segment test; non-convex sets fail it.
Bottom row: Convex functions have one minimum; non-convex functions may have many.

F1 insight: a spring stiffness setting has a smooth optimal (convex).
Full car design is non-convex — different philosophies can each be local optima.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Demonstrate: gradient descent finds the global optimum on convex functions</span>
<span class="c1"># but can get stuck on non-convex functions</span>
<span class="c1"># F1 analogy: setup tuning (convex) vs full car design (non-convex)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">gradient_descent_1d</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">30</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simple 1D gradient descent — like an engineer incrementally tweaking a setup parameter.</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        f: Objective function (lap time penalty)</span>
<span class="sd">        df: Gradient of objective (sensitivity to parameter change)</span>
<span class="sd">        x0: Starting point (initial setup)</span>
<span class="sd">        lr: Learning rate (how big each setup change is)</span>
<span class="sd">        n_steps: Number of iterations</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        List of (x, f(x)) at each step</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">path</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x0</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x0</span><span class="p">))]</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x0</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">lr</span> <span class="o">*</span> <span class="n">df</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">path</span>


<span class="c1"># Convex: f(x) = (x-1)^2 — like spring stiffness optimization</span>
<span class="n">f_convex</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="n">df_convex</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># Non-convex: f(x) = sin(3x) + 0.3*x^2 — like full car design</span>
<span class="n">f_nonconvex</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.3</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span>
<span class="n">df_nonconvex</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.6</span><span class="o">*</span><span class="n">x</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">x_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>

<span class="c1"># Convex case (spring stiffness — any starting point finds the sweet spot)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_range</span><span class="p">,</span> <span class="n">f_convex</span><span class="p">(</span><span class="n">x_range</span><span class="p">),</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;f(x) = (x-1)²&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">x0</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">ls</span> <span class="ow">in</span> <span class="p">[(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mf">3.5</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">)]:</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">gradient_descent_1d</span><span class="p">(</span><span class="n">f_convex</span><span class="p">,</span> <span class="n">df_convex</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">xs</span><span class="p">,</span> <span class="n">ys</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">path</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Start setup=</span><span class="si">{</span><span class="n">x0</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ys</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Convex: Both starting setups find the sweet spot&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Setup parameter&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Lap time penalty&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Non-convex case (full car design — starting concept matters)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_range</span><span class="p">,</span> <span class="n">f_nonconvex</span><span class="p">(</span><span class="n">x_range</span><span class="p">),</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;f(x) = sin(3x) + 0.3x²&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">x0</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">ls</span> <span class="ow">in</span> <span class="p">[(</span><span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">)]:</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">gradient_descent_1d</span><span class="p">(</span><span class="n">f_nonconvex</span><span class="p">,</span> <span class="n">df_nonconvex</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
    <span class="n">xs</span><span class="p">,</span> <span class="n">ys</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">path</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Start concept=</span><span class="si">{</span><span class="n">x0</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ys</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Non-convex: Different starting concepts, different local minima&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Design parameter&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Lap time penalty&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Convex (spring stiffness): Every starting point leads to the same optimal setup.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Non-convex (car design): Different starting concepts can converge to different designs.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">This is why neural network training (non-convex) depends on initialization,&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;while logistic regression (convex) converges to the same solution regardless.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;And why F1 teams sometimes need a bold concept reset to escape a local minimum.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/56a3859a4e5ee887974c024fd66c81042cb3e11baf9dd28acc252e0f21985da0.png" src="../_images/56a3859a4e5ee887974c024fd66c81042cb3e11baf9dd28acc252e0f21985da0.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Convex (spring stiffness): Every starting point leads to the same optimal setup.
Non-convex (car design): Different starting concepts can converge to different designs.

This is why neural network training (non-convex) depends on initialization,
while logistic regression (convex) converges to the same solution regardless.
And why F1 teams sometimes need a bold concept reset to escape a local minimum.
</pre></div>
</div>
</div>
</div>
</section>
<section id="deep-dive-common-convex-functions-in-ml">
<h3>Deep Dive: Common Convex Functions in ML<a class="headerlink" href="#deep-dive-common-convex-functions-in-ml" title="Link to this heading">#</a></h3>
<p>Many loss functions used in ML are convex by design:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Function</p></th>
<th class="head"><p>Formula</p></th>
<th class="head"><p>Convex?</p></th>
<th class="head"><p>Used in</p></th>
<th class="head"><p>F1 Parallel</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Squared error</strong></p></td>
<td><p><span class="math notranslate nohighlight">\((y - \hat{y})^2\)</span></p></td>
<td><p>Yes (strictly)</p></td>
<td><p>Linear regression</p></td>
<td><p>Lap time vs predicted lap time (squared gap)</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Cross-entropy</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(-y \log \hat{y} - (1-y)\log(1-\hat{y})\)</span></p></td>
<td><p>Yes (strictly)</p></td>
<td><p>Logistic regression</p></td>
<td><p>Rain probability calibration</p></td>
</tr>
<tr class="row-even"><td><p><strong>Hinge loss</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(\max(0, 1 - y \hat{y})\)</span></p></td>
<td><p>Yes (not strictly)</p></td>
<td><p>SVM</p></td>
<td><p>Penalty for being on the wrong side of the strategy cutoff</p></td>
</tr>
<tr class="row-odd"><td><p><strong><span class="math notranslate nohighlight">\(\ell_2\)</span> penalty</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(|\mathbf{w}|_2^2\)</span></p></td>
<td><p>Yes (strictly)</p></td>
<td><p>Ridge regression</p></td>
<td><p>Budget cap penalty (quadratic cost of overspending)</p></td>
</tr>
<tr class="row-even"><td><p><strong><span class="math notranslate nohighlight">\(\ell_1\)</span> penalty</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(|\mathbf{w}|_1\)</span></p></td>
<td><p>Yes (not strictly)</p></td>
<td><p>LASSO</p></td>
<td><p>Weight ballast allocation (each kg costs the same)</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Neural network loss</strong></p></td>
<td><p>Complex composition</p></td>
<td><p>No (generally)</p></td>
<td><p>Deep learning</p></td>
<td><p>Full car performance sim (highly non-convex)</p></td>
</tr>
</tbody>
</table>
</div>
<section id="id10">
<h4>Key Insight<a class="headerlink" href="#id10" title="Link to this heading">#</a></h4>
<p>A sum of convex functions is convex. This is why “loss + regularization” stays convex when both components are convex: the composite objective inherits the nice optimization properties of its parts. In F1 terms, if each sub-system (aero, engine, suspension) has a convex performance curve, and the total lap time is a weighted sum of these, the total is also convex — making optimization tractable.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize common ML loss functions and their convexity</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>

<span class="c1"># Squared loss</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Squared Loss: (y - y_hat)²&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Prediction error (residual)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Loss&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">,</span> <span class="s1">&#39;Convex</span><span class="se">\n</span><span class="s1">Smooth</span><span class="se">\n</span><span class="s1">Strictly convex&#39;</span><span class="p">,</span>
        <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span>
        <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Hinge loss</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">hinge</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">z</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">hinge</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Hinge Loss: max(0, 1 - y*y_hat)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Margin (y * y_hat)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Loss&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">,</span> <span class="s1">&#39;Convex</span><span class="se">\n</span><span class="s1">Not smooth (has a kink)</span><span class="se">\n</span><span class="s1">Not strictly convex&#39;</span><span class="p">,</span>
        <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span>
        <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Cross-entropy / logistic loss</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">logistic_loss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">z</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">logistic_loss</span><span class="p">,</span> <span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Logistic Loss: log(1 + exp(-z))&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Margin (y * y_hat)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Loss&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">,</span> <span class="s1">&#39;Convex</span><span class="se">\n</span><span class="s1">Smooth</span><span class="se">\n</span><span class="s1">Strictly convex&#39;</span><span class="p">,</span>
        <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span>
        <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;All three are convex — gradient descent will find the global minimum.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Squared loss is smooth and easy to optimize.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hinge loss has a &#39;kink&#39; at 1, requiring subgradient methods.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Logistic loss is a smooth approximation of hinge loss.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">F1 parallel: all three are like single-parameter setup curves — one clear optimum.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3de1a9a19899d7ba5a9fbd4b8ee70b813c5d38c2603d1cdfd8f7d4f5c6689e05.png" src="../_images/3de1a9a19899d7ba5a9fbd4b8ee70b813c5d38c2603d1cdfd8f7d4f5c6689e05.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>All three are convex — gradient descent will find the global minimum.
Squared loss is smooth and easy to optimize.
Hinge loss has a &#39;kink&#39; at 1, requiring subgradient methods.
Logistic loss is a smooth approximation of hinge loss.

F1 parallel: all three are like single-parameter setup curves — one clear optimum.
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<hr class="docutils" />
<section id="constrained-optimization-lagrange-multipliers">
<h2>6. Constrained Optimization &amp; Lagrange Multipliers<a class="headerlink" href="#constrained-optimization-lagrange-multipliers" title="Link to this heading">#</a></h2>
<section id="id11">
<h3>Intuitive Explanation<a class="headerlink" href="#id11" title="Link to this heading">#</a></h3>
<p>How do you minimize a function when you must stay on a specific curve or surface? This is the <strong>constrained optimization</strong> problem.</p>
<p><strong>The setup:</strong>
$<span class="math notranslate nohighlight">\(\min_{x} f(x) \quad \text{subject to} \quad g(x) = 0\)</span>$</p>
<p><strong>Lagrange’s insight (1788):</strong> At the constrained optimum, the gradient of the objective <span class="math notranslate nohighlight">\(\nabla f\)</span> must be parallel to the gradient of the constraint <span class="math notranslate nohighlight">\(\nabla g\)</span>. If they were not parallel, you could slide along the constraint and still improve the objective.</p>
<p>This gives us the <strong>Lagrangian</strong>:
$<span class="math notranslate nohighlight">\(\mathcal{L}(x, \lambda) = f(x) + \lambda \, g(x)\)</span>$</p>
<p>The optimal point satisfies:
$<span class="math notranslate nohighlight">\(\nabla_x \mathcal{L} = 0 \quad \text{and} \quad \nabla_\lambda \mathcal{L} = 0\)</span>$</p>
<p>The variable <span class="math notranslate nohighlight">\(\lambda\)</span> is called the <strong>Lagrange multiplier</strong>. It tells you the rate at which the optimal objective value changes as you relax the constraint.</p>
</section>
<section id="id12">
<h3>The F1 Connection<a class="headerlink" href="#id12" title="Link to this heading">#</a></h3>
<p>Imagine you want to <strong>minimize lap time</strong> (the objective) but the FIA requires a <strong>minimum car weight</strong> of 798 kg (the constraint). You cannot just build the lightest car possible — you must hit exactly 798 kg.</p>
<p>The Lagrange multiplier <span class="math notranslate nohighlight">\(\lambda\)</span> answers the question every team asks: “If the FIA dropped the minimum weight by 1 kg, how much faster would our lap time be?” That sensitivity — seconds per kilogram — is the shadow price of the weight regulation.</p>
<p><strong>Hiking analogy:</strong> Imagine hiking downhill but you must stay on a trail (the constraint). You stop when the steepest downhill direction is perpendicular to the trail — because moving along the trail no longer takes you downhill.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Geometric visualization of Lagrange multipliers</span>
<span class="c1"># F1: Minimize aero_drag² + engine_weight² subject to aero_drag + engine_weight = 4</span>
<span class="c1"># (Balance between aero efficiency and engine mass under a total weight constraint)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="n">x_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
<span class="n">y_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x_range</span><span class="p">,</span> <span class="n">y_range</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">X</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Y</span><span class="o">**</span><span class="mi">2</span>  <span class="c1"># objective: minimize combined penalty</span>

<span class="c1"># Contours of the objective</span>
<span class="n">levels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">32</span><span class="p">]</span>
<span class="n">contour</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">contour</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%.0f</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>

<span class="c1"># Constraint: aero_drag + engine_weight = 4 (total weight budget)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_range</span><span class="p">,</span> <span class="mi">4</span> <span class="o">-</span> <span class="n">x_range</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Constraint: aero + engine = 4 (weight budget)&#39;</span><span class="p">)</span>

<span class="c1"># Optimal point: x = y = 2 (by symmetry, or solve the system)</span>
<span class="n">opt_x</span><span class="p">,</span> <span class="n">opt_y</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">opt_x</span><span class="p">,</span> <span class="n">opt_y</span><span class="p">,</span> <span class="s1">&#39;r*&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Constrained optimum (2, 2)&#39;</span><span class="p">)</span>

<span class="c1"># Draw gradients at the optimal point</span>
<span class="c1"># grad f = (2x, 2y) = (4, 4)</span>
<span class="c1"># grad g = (1, 1)  where g(x,y) = x + y - 4</span>
<span class="n">scale</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">opt_x</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">scale</span><span class="p">,</span> <span class="n">opt_y</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">scale</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">opt_x</span><span class="p">,</span> <span class="n">opt_y</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">opt_x</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">scale</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">opt_y</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">scale</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">,</span> <span class="s1">&#39;grad(f) = (4, 4)&#39;</span><span class="p">,</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">opt_x</span> <span class="o">+</span> <span class="mi">1</span><span class="o">*</span><span class="n">scale</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">opt_y</span> <span class="o">+</span> <span class="mi">1</span><span class="o">*</span><span class="n">scale</span><span class="o">*</span><span class="mi">2</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">opt_x</span><span class="p">,</span> <span class="n">opt_y</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">opt_x</span> <span class="o">+</span> <span class="mi">1</span><span class="o">*</span><span class="n">scale</span><span class="o">*</span><span class="mi">2</span> <span class="o">-</span> <span class="mf">0.7</span><span class="p">,</span> <span class="n">opt_y</span> <span class="o">+</span> <span class="mi">1</span><span class="o">*</span><span class="n">scale</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.2</span><span class="p">,</span> <span class="s1">&#39;grad(g) = (1, 1)&#39;</span><span class="p">,</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="c1"># Unconstrained optimum</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;b*&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Unconstrained optimum (0, 0)&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Aero Drag Parameter&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Engine Weight Parameter&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Lagrange Multipliers: Gradient Alignment at Regulation Boundary&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;At the constrained optimum (2, 2):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  grad(f) = (4, 4) is parallel to grad(g) = (1, 1)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  lambda = 4 (the Lagrange multiplier: grad(f) = lambda * grad(g))&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  The multiplier lambda = 4 means: relaxing the weight budget by 1 unit&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  would improve the combined penalty by approximately 4 units.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  In F1 terms: each kg of weight relief is worth 4 units of performance.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/84bdfe03b2a0ce09d48ee1e366baffa49ba0aab803a97c88cbf2332a056d3194.png" src="../_images/84bdfe03b2a0ce09d48ee1e366baffa49ba0aab803a97c88cbf2332a056d3194.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>At the constrained optimum (2, 2):
  grad(f) = (4, 4) is parallel to grad(g) = (1, 1)
  lambda = 4 (the Lagrange multiplier: grad(f) = lambda * grad(g))
  The multiplier lambda = 4 means: relaxing the weight budget by 1 unit
  would improve the combined penalty by approximately 4 units.
  In F1 terms: each kg of weight relief is worth 4 units of performance.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solving constrained optimization with scipy.optimize.minimize</span>
<span class="c1"># F1 problem: minimize aero_drag² + engine_weight² subject to aero + engine = 4</span>

<span class="k">def</span><span class="w"> </span><span class="nf">lap_time_penalty</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Combined penalty: aero_drag² + engine_weight².&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>

<span class="k">def</span><span class="w"> </span><span class="nf">weight_budget_constraint</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Weight budget: aero_drag + engine_weight = 4.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">4</span>  <span class="c1"># equals zero at feasibility</span>

<span class="c1"># Using SLSQP (Sequential Least Squares Quadratic Programming)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span>
    <span class="n">lap_time_penalty</span><span class="p">,</span>
    <span class="n">x0</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>  <span class="c1"># starting guess</span>
    <span class="n">method</span><span class="o">=</span><span class="s1">&#39;SLSQP&#39;</span><span class="p">,</span>
    <span class="n">constraints</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;eq&#39;</span><span class="p">,</span> <span class="s1">&#39;fun&#39;</span><span class="p">:</span> <span class="n">weight_budget_constraint</span><span class="p">}</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== Constrained Optimization with scipy ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Optimal aero parameter:   </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Optimal engine parameter: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Minimum penalty: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">fun</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Constraint satisfied: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">weight_budget_constraint</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Solver converged: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">success</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Verify: analytical solution is (2, 2) with f = 8</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Analytical solution: (2, 2), f = 8&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Match: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">])</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">fun</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== Constrained Optimization with scipy ===
Optimal aero parameter:   2.0000
Optimal engine parameter: 2.0000
Minimum penalty: 8.0000
Constraint satisfied: True
Solver converged: True

Analytical solution: (2, 2), f = 8
Match: True
</pre></div>
</div>
</div>
</div>
</section>
<section id="kkt-conditions-the-full-picture">
<h3>KKT Conditions: The Full Picture<a class="headerlink" href="#kkt-conditions-the-full-picture" title="Link to this heading">#</a></h3>
<p>Lagrange multipliers handle <strong>equality</strong> constraints. For <strong>inequality</strong> constraints (<span class="math notranslate nohighlight">\(g_i(x) \leq 0\)</span>), we need the <strong>Karush-Kuhn-Tucker (KKT) conditions</strong>, which generalize Lagrange multipliers.</p>
<p>For the problem:
$<span class="math notranslate nohighlight">\(\min_x f(x) \quad \text{s.t.} \quad g_i(x) \leq 0, \quad h_j(x) = 0\)</span>$</p>
<p>The KKT conditions are:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Condition</p></th>
<th class="head"><p>Statement</p></th>
<th class="head"><p>Intuition</p></th>
<th class="head"><p>F1 Parallel</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Stationarity</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(\nabla f + \sum \mu_i \nabla g_i + \sum \lambda_j \nabla h_j = 0\)</span></p></td>
<td><p>Gradient balance at optimum</p></td>
<td><p>All design forces in equilibrium</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Primal feasibility</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(g_i(x) \leq 0, \; h_j(x) = 0\)</span></p></td>
<td><p>Solution must be feasible</p></td>
<td><p>Car passes scrutineering</p></td>
</tr>
<tr class="row-even"><td><p><strong>Dual feasibility</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(\mu_i \geq 0\)</span></p></td>
<td><p>Inequality multipliers are non-negative</p></td>
<td><p>Regulations can only restrict, never help</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Complementary slackness</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(\mu_i \, g_i(x) = 0\)</span></p></td>
<td><p>Either constraint is active or multiplier is zero</p></td>
<td><p>If you are not at the weight limit, the weight rule does not affect you</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>What this means:</strong></p>
<ul class="simple">
<li><p>If a constraint is <strong>not active</strong> (<span class="math notranslate nohighlight">\(g_i(x) &lt; 0\)</span>, you are strictly inside the boundary), then <span class="math notranslate nohighlight">\(\mu_i = 0\)</span> — the constraint does not affect the solution. (If your car is already heavier than the minimum weight, the weight rule is irrelevant.)</p></li>
<li><p>If a constraint <strong>is active</strong> (<span class="math notranslate nohighlight">\(g_i(x) = 0\)</span>, you are on the boundary), then <span class="math notranslate nohighlight">\(\mu_i &gt; 0\)</span> — the constraint is “pushing back” and preventing you from going further. (If you are right at minimum weight, the regulation is actively constraining your design.)</p></li>
</ul>
<p>For <strong>convex</strong> problems, the KKT conditions are both necessary and sufficient for optimality.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize KKT conditions: inequality constraints</span>
<span class="c1"># F1 scenario: minimize lap time penalty subject to weight regulations</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">x_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
<span class="n">y_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x_range</span><span class="p">,</span> <span class="n">y_range</span><span class="p">)</span>

<span class="c1"># Case 1: Optimal design is already within regulations (constraint not active)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">Z</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span> <span class="o">-</span> <span class="mf">1.5</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">Y</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>  <span class="c1"># penalty landscape: optimum at (1.5, 1)</span>
<span class="n">contour</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">contour</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%.1f</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="c1"># Regulation region: aero + engine &lt;= 4, both &gt;= 0</span>
<span class="n">feas_verts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="n">feas_poly</span> <span class="o">=</span> <span class="n">Polygon</span><span class="p">(</span><span class="n">feas_verts</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Regulation-compliant region&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">feas_poly</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;r*&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Optimum (1.5, 1) -- interior&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Regulation NOT Active (mu = 0)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Aero parameter&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Engine parameter&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Case 2: Ideal design violates regulations -&gt; constraint active</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">Z2</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">Y</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>  <span class="c1"># penalty landscape: optimum at (3, 3) — outside regs</span>
<span class="n">contour</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z2</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">contour</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%.1f</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="n">feas_poly2</span> <span class="o">=</span> <span class="n">Polygon</span><span class="p">(</span><span class="n">feas_verts</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Regulation-compliant region&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">feas_poly2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Constrained optimum: closest point on aero+engine=4 to (3,3) is (2,2)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;b*&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Unconstrained optimum (3, 3) -- illegal!&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;r*&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Constrained optimum (2, 2) -- on boundary&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Regulation IS Active (mu &gt; 0)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Aero parameter&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Engine parameter&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Left: The ideal design (1.5, 1) is already within regulations.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  -&gt; The regulation is NOT active, and the multiplier mu = 0.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  -&gt; The regulation doesn&#39;t affect the design at all (like a weight rule&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;     that&#39;s irrelevant because the car is already heavy enough).&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Right: The ideal design (3, 3) VIOLATES regulations.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  -&gt; The regulation IS active, forcing the design to (2, 2) on the boundary.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  -&gt; The multiplier mu &gt; 0, representing the performance cost of the regulation.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  -&gt; This is exactly what happens when floor rules constrain aero development.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/56272c1167b94b792f4a4890cd6b9159a4bf0401b56c6069889b4e56bafe2e56.png" src="../_images/56272c1167b94b792f4a4890cd6b9159a4bf0401b56c6069889b4e56bafe2e56.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Left: The ideal design (1.5, 1) is already within regulations.
  -&gt; The regulation is NOT active, and the multiplier mu = 0.
  -&gt; The regulation doesn&#39;t affect the design at all (like a weight rule
     that&#39;s irrelevant because the car is already heavy enough).

Right: The ideal design (3, 3) VIOLATES regulations.
  -&gt; The regulation IS active, forcing the design to (2, 2) on the boundary.
  -&gt; The multiplier mu &gt; 0, representing the performance cost of the regulation.
  -&gt; This is exactly what happens when floor rules constrain aero development.
</pre></div>
</div>
</div>
</div>
</section>
<section id="deep-dive-complementary-slackness-the-either-or-rule">
<h3>Deep Dive: Complementary Slackness — The Either/Or Rule<a class="headerlink" href="#deep-dive-complementary-slackness-the-either-or-rule" title="Link to this heading">#</a></h3>
<p>Complementary slackness (<span class="math notranslate nohighlight">\(\mu_i \cdot g_i(x) = 0\)</span>) is perhaps the most elegant condition. It says:</p>
<p>For each inequality constraint, exactly one of two things is true:</p>
<ol class="arabic simple">
<li><p>The constraint is <strong>slack</strong> (<span class="math notranslate nohighlight">\(g_i(x) &lt; 0\)</span>): the boundary is not reached, so the multiplier is zero (<span class="math notranslate nohighlight">\(\mu_i = 0\)</span>). In F1: the car is under the budget cap, so the cap does not affect strategy.</p></li>
<li><p>The constraint is <strong>tight</strong> (<span class="math notranslate nohighlight">\(g_i(x) = 0\)</span>): the boundary is hit, and the multiplier is positive (<span class="math notranslate nohighlight">\(\mu_i &gt; 0\)</span>). In F1: the team is right at the budget cap, and every dollar matters.</p></li>
</ol>
<p>In ML terms:</p>
<ul class="simple">
<li><p>In an SVM, most data points have <span class="math notranslate nohighlight">\(\mu_i = 0\)</span> — they do not affect the decision boundary.</p></li>
<li><p>Only the <strong>support vectors</strong> (points on the margin boundary) have <span class="math notranslate nohighlight">\(\mu_i &gt; 0\)</span>.</p></li>
<li><p>This is why SVMs are sparse: the solution depends only on a few critical data points.</p></li>
</ul>
<p><strong>F1 parallel:</strong> Think of regulations as constraints on car design. Most regulations are “slack” — the team is well within the limit and does not even think about them. But a few regulations are “tight” — the team is right at the boundary, and those are the ones that actually shape the car. Just like support vectors shape the SVM decision boundary.</p>
</section>
</section>
<hr class="docutils" />
<section id="connection-to-machine-learning">
<h2>7. Connection to Machine Learning<a class="headerlink" href="#connection-to-machine-learning" title="Link to this heading">#</a></h2>
<section id="ml-as-optimization">
<h3>ML as Optimization<a class="headerlink" href="#ml-as-optimization" title="Link to this heading">#</a></h3>
<p>Nearly every ML algorithm can be framed as an optimization problem. And every one of these has a natural F1 parallel — because F1 engineering is also, fundamentally, constrained optimization.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Algorithm</p></th>
<th class="head"><p>Objective</p></th>
<th class="head"><p>Constraints</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>F1 Parallel</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Linear regression</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(\min_w |Xw - y|^2\)</span></p></td>
<td><p>None</p></td>
<td><p>Unconstrained convex</p></td>
<td><p>Best-fit telemetry model</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Ridge regression</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(\min_w |Xw - y|^2 + \alpha|w|^2\)</span></p></td>
<td><p>None (equivalent to constrained)</p></td>
<td><p>Unconstrained convex</p></td>
<td><p>Lap time model with complexity penalty</p></td>
</tr>
<tr class="row-even"><td><p><strong>LASSO</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(\min_w |Xw - y|^2 + \alpha|w|_1\)</span></p></td>
<td><p>None (equivalent to constrained)</p></td>
<td><p>Unconstrained convex</p></td>
<td><p>Feature-sparse telemetry model</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Logistic regression</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(\min_w \sum \log(1 + e^{-y_i w^T x_i})\)</span></p></td>
<td><p>None</p></td>
<td><p>Unconstrained convex</p></td>
<td><p>Rain/dry race outcome prediction</p></td>
</tr>
<tr class="row-even"><td><p><strong>SVM (primal)</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(\min_{w,b} \frac{1}{2}|w|^2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(y_i(w^T x_i + b) \geq 1\)</span></p></td>
<td><p>Constrained convex (QP)</p></td>
<td><p>Maximum-margin tire strategy classifier</p></td>
</tr>
<tr class="row-odd"><td><p><strong>SVM (dual)</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(\max_\alpha \sum \alpha_i - \frac{1}{2}\sum \alpha_i \alpha_j y_i y_j x_i^T x_j\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0 \leq \alpha_i \leq C\)</span></p></td>
<td><p>Constrained convex (QP)</p></td>
<td><p>Driver-view of the same classifier</p></td>
</tr>
<tr class="row-even"><td><p><strong>Neural networks</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(\min_\theta \mathcal{L}(f_\theta(X), y)\)</span></p></td>
<td><p>None</p></td>
<td><p>Unconstrained <strong>non-convex</strong></p></td>
<td><p>Full race strategy simulator</p></td>
</tr>
</tbody>
</table>
</div>
<p>Notice: everything except neural networks is convex. This is why classical ML has nice convergence guarantees, while deep learning requires more art (learning rate schedules, initialization strategies, etc.) — just like how tuning a single spring is straightforward, but designing an entire F1 car from scratch is a deeply non-convex challenge.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Demonstrate: SVM as a constrained optimization problem</span>
<span class="c1"># F1 framing: classifying race strategies as &quot;aggressive&quot; vs &quot;conservative&quot;</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.svm</span><span class="w"> </span><span class="kn">import</span> <span class="n">SVC</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_blobs</span>

<span class="c1"># Generate data: two clusters representing aggressive vs conservative strategies</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">make_blobs</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">centers</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">cluster_std</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">y_train</span> <span class="o">-</span> <span class="mi">1</span>  <span class="c1"># Convert to {-1, +1}: aggressive (-1) vs conservative (+1)</span>

<span class="c1"># Train SVM — finding the maximum-margin boundary between strategies</span>
<span class="n">svm</span> <span class="o">=</span> <span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span>
<span class="n">svm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Extract the optimization solution</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">intercept_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">support_vectors</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">support_vectors_</span>
<span class="n">n_support</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">support_vectors</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== SVM as Constrained Optimization ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Weight vector w: [</span><span class="si">{</span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bias b: </span><span class="si">{</span><span class="n">b</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Margin width: </span><span class="si">{</span><span class="mi">2</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of support vectors: </span><span class="si">{</span><span class="n">n_support</span><span class="si">}</span><span class="s2"> out of </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span><span class="si">}</span><span class="s2"> strategies&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Only </span><span class="si">{</span><span class="n">n_support</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span><span class="si">}</span><span class="s2"> strategies have non-zero dual variables (alpha &gt; 0).&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This is complementary slackness in action!&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Like F1 regs: only the binding constraints shape the solution.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== SVM as Constrained Optimization ===
Weight vector w: [0.2700, -0.2663]
Bias b: 1.3841
Margin width: 5.2737
Number of support vectors: 2 out of 40 strategies

Only 2/40 strategies have non-zero dual variables (alpha &gt; 0).
This is complementary slackness in action!
Like F1 regs: only the binding constraints shape the solution.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize the SVM solution with margin and support vectors</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="c1"># Plot data points — aggressive vs conservative strategies</span>
<span class="k">for</span> <span class="bp">cls</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="p">[(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;Aggressive strategy&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;Conservative strategy&#39;</span><span class="p">)]:</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">y_train</span> <span class="o">==</span> <span class="bp">cls</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X_train</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
               <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

<span class="c1"># Plot support vectors (the critical boundary strategies)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">support_vectors</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">support_vectors</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
           <span class="n">facecolors</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span>
           <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Support vectors (</span><span class="si">{</span><span class="n">n_support</span><span class="si">}</span><span class="s1">) — boundary strategies&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="c1"># Plot decision boundary and margins</span>
<span class="n">x_boundary</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">X_train</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">X_train</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

<span class="c1"># Decision boundary: w[0]*x + w[1]*y + b = 0</span>
<span class="n">y_boundary</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">x_boundary</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span> <span class="o">/</span> <span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">y_margin_pos</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">x_boundary</span> <span class="o">+</span> <span class="n">b</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">y_margin_neg</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">x_boundary</span> <span class="o">+</span> <span class="n">b</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_boundary</span><span class="p">,</span> <span class="n">y_boundary</span><span class="p">,</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Decision boundary&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_boundary</span><span class="p">,</span> <span class="n">y_margin_pos</span><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Margin boundaries&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_boundary</span><span class="p">,</span> <span class="n">y_margin_neg</span><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_boundary</span><span class="p">,</span> <span class="n">y_margin_neg</span><span class="p">,</span> <span class="n">y_margin_pos</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.08</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Risk Factor (tire degradation rate)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Reward Factor (pace advantage)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;SVM: Maximum-Margin Strategy Classifier (Constrained QP)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">X_train</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">X_train</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">X_train</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">X_train</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The SVM solves: min 1/2 ||w||^2 subject to y_i(w.x_i + b) &gt;= 1&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This is a quadratic program (QP) — convex with linear constraints.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The support vectors are the strategies with active constraints (on the margin).&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Just like F1: only the regulations you&#39;re pushing against actually matter.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/948f279912afa3b03b1d391328088f5a16e0b6262c1a71c8ca8918d81527ec7f.png" src="../_images/948f279912afa3b03b1d391328088f5a16e0b6262c1a71c8ca8918d81527ec7f.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The SVM solves: min 1/2 ||w||^2 subject to y_i(w.x_i + b) &gt;= 1
This is a quadratic program (QP) — convex with linear constraints.
The support vectors are the strategies with active constraints (on the margin).
Just like F1: only the regulations you&#39;re pushing against actually matter.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Demonstrate: Regularization as a constraint</span>
<span class="c1"># F1 framing: budget cap as a constraint on development spending</span>
<span class="c1"># Ridge regression: min ||Xw - y||^2 + alpha * ||w||^2</span>
<span class="c1"># Equivalent to: min ||Xw - y||^2 subject to ||w||^2 &lt;= t (budget cap)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Create a simple telemetry prediction problem</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">w_true</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">])</span>  <span class="c1"># true relationship: speed depends on downforce and drag</span>
<span class="n">X_reg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">y_reg</span> <span class="o">=</span> <span class="n">X_reg</span> <span class="o">@</span> <span class="n">w_true</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>

<span class="c1"># Compute loss surface</span>
<span class="n">w1_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">w2_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">W1</span><span class="p">,</span> <span class="n">W2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">w1_range</span><span class="p">,</span> <span class="n">w2_range</span><span class="p">)</span>

<span class="n">Loss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">W1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">w1_range</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">w2_range</span><span class="p">)):</span>
        <span class="n">w_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">W1</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="n">W2</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]])</span>
        <span class="n">Loss</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">X_reg</span> <span class="o">@</span> <span class="n">w_test</span> <span class="o">-</span> <span class="n">y_reg</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_reg</span><span class="p">)</span>

<span class="c1"># Left: Regularization view (penalized objective — &quot;cost of complexity&quot;)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">W1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">Loss</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

<span class="c1"># Show effect of different regularization strengths (budget caps)</span>
<span class="k">for</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;No cap (alpha=0)&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="s1">&#39;Soft cap (alpha=2)&#39;</span><span class="p">),</span>
                            <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;Strict cap (alpha=10)&#39;</span><span class="p">)]:</span>
    <span class="n">w_ridge</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">X_reg</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">X_reg</span> <span class="o">+</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">X_reg</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">y_reg</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w_ridge</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">w_ridge</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;w₁ (downforce coefficient)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;w₂ (drag coefficient)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Regularization Shrinks Weights (Like a Budget Cap)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Right: Constraint view (norm ball — &quot;budget limit&quot;)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">W1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">Loss</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

<span class="c1"># L2 constraint ball (budget cap circles)</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="k">for</span> <span class="n">radius</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">ls</span> <span class="ow">in</span> <span class="p">[(</span><span class="mf">2.0</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mf">3.0</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mf">5.0</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">)]:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">radius</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">radius</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">linestyle</span><span class="o">=</span><span class="n">ls</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;||w||₂ &lt;= </span><span class="si">{</span><span class="n">radius</span><span class="si">}</span><span class="s1"> (budget=</span><span class="si">{</span><span class="n">radius</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>

<span class="c1"># OLS solution (no constraint — unlimited budget)</span>
<span class="n">w_ols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">X_reg</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">X_reg</span><span class="p">,</span> <span class="n">X_reg</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">y_reg</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w_ols</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">w_ols</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;r*&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;OLS (no budget cap)&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;w₁ (downforce coefficient)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;w₂ (drag coefficient)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Equivalent View: Budget Cap on Model Complexity&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Left: Adding alpha*||w||^2 to the loss shrinks weights toward zero.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  Like a budget cap that penalizes excessive development spending.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Right: Equivalent to constraining ||w||_2 &lt;= t (Lagrangian duality).&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  Like a hard budget cap: you cannot exceed the limit, period.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">This equivalence is Lagrangian duality in action:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  Penalized form: min L(w) + alpha*R(w)    [cost overrun penalty]&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  Constrained form: min L(w) s.t. R(w) &lt;= t [hard budget cap]&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  The multiplier alpha and the budget t are dual to each other.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/l3/qp293kmd0ps5v659jn3njrpc0000gn/T/ipykernel_5834/3112395695.py:64: UserWarning: Glyph 8321 (\N{SUBSCRIPT ONE}) missing from font(s) Arial.
  plt.tight_layout()
/var/folders/l3/qp293kmd0ps5v659jn3njrpc0000gn/T/ipykernel_5834/3112395695.py:64: UserWarning: Glyph 8322 (\N{SUBSCRIPT TWO}) missing from font(s) Arial.
  plt.tight_layout()
/Users/danshah/claude_projects/learning/venv/lib/python3.13/site-packages/IPython/core/pylabtools.py:170: UserWarning: Glyph 8322 (\N{SUBSCRIPT TWO}) missing from font(s) Arial.
  fig.canvas.print_figure(bytes_io, **kw)
/Users/danshah/claude_projects/learning/venv/lib/python3.13/site-packages/IPython/core/pylabtools.py:170: UserWarning: Glyph 8321 (\N{SUBSCRIPT ONE}) missing from font(s) Arial.
  fig.canvas.print_figure(bytes_io, **kw)
</pre></div>
</div>
<img alt="../_images/69c2cc7c4b780258f5bc72fff349410baa28b2ee204831ed5a71930f5c1c612b.png" src="../_images/69c2cc7c4b780258f5bc72fff349410baa28b2ee204831ed5a71930f5c1c612b.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Left: Adding alpha*||w||^2 to the loss shrinks weights toward zero.
  Like a budget cap that penalizes excessive development spending.
Right: Equivalent to constraining ||w||_2 &lt;= t (Lagrangian duality).
  Like a hard budget cap: you cannot exceed the limit, period.

This equivalence is Lagrangian duality in action:
  Penalized form: min L(w) + alpha*R(w)    [cost overrun penalty]
  Constrained form: min L(w) s.t. R(w) &lt;= t [hard budget cap]
  The multiplier alpha and the budget t are dual to each other.
</pre></div>
</div>
</div>
</div>
</section>
<section id="why-this-matters-in-machine-learning">
<h3>Why This Matters in Machine Learning<a class="headerlink" href="#why-this-matters-in-machine-learning" title="Link to this heading">#</a></h3>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Optimization Concept</p></th>
<th class="head"><p>ML Application</p></th>
<th class="head"><p>How It’s Used</p></th>
<th class="head"><p>F1 Parallel</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Objective function</strong></p></td>
<td><p>Loss function</p></td>
<td><p>Measures how wrong the model is</p></td>
<td><p>Lap time (lower is better)</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Constraints</strong></p></td>
<td><p>Regularization, fairness constraints</p></td>
<td><p>Limits model complexity or enforces properties</p></td>
<td><p>FIA regulations (budget cap, weight, fuel flow)</p></td>
</tr>
<tr class="row-even"><td><p><strong>Feasible region</strong></p></td>
<td><p>Weight space satisfying constraints</p></td>
<td><p>Set of allowed model parameters</p></td>
<td><p>All legal car designs</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Convexity</strong></p></td>
<td><p>Guarantees on convergence</p></td>
<td><p>Convex losses guarantee finding the best model</p></td>
<td><p>Single-parameter setup: one sweet spot</p></td>
</tr>
<tr class="row-even"><td><p><strong>Lagrange multipliers</strong></p></td>
<td><p>SVM dual, regularization theory</p></td>
<td><p>Enable kernel trick, explain regularization</p></td>
<td><p>Shadow price of each regulation</p></td>
</tr>
<tr class="row-odd"><td><p><strong>KKT conditions</strong></p></td>
<td><p>Support vectors, active constraints</p></td>
<td><p>Identify which data points matter</p></td>
<td><p>Which regulations actually constrain the car</p></td>
</tr>
<tr class="row-even"><td><p><strong>Duality</strong></p></td>
<td><p>SVM formulation, ELBO in VAEs</p></td>
<td><p>Provides alternative problem views</p></td>
<td><p>Team vs driver perspective</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Linear programming</strong></p></td>
<td><p>Network flow, assignment, scheduling</p></td>
<td><p>Combinatorial ML problems</p></td>
<td><p>Pit stop timing and tire allocation</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<hr class="docutils" />
<section id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Link to this heading">#</a></h2>
<section id="exercise-1-formulate-and-solve-a-race-strategy-lp">
<h3>Exercise 1: Formulate and Solve a Race Strategy LP<a class="headerlink" href="#exercise-1-formulate-and-solve-a-race-strategy-lp" title="Link to this heading">#</a></h3>
<p>An F1 team is planning a 2-stop race and must decide how to allocate resources across two development areas:</p>
<ul class="simple">
<li><p>Each unit of <strong>aero development</strong> costs 3 wind tunnel hours and 1 CFD session, and gains 8 points of downforce.</p></li>
<li><p>Each unit of <strong>engine mapping</strong> costs 1 dyno hour and 2 CFD sessions, and gains 5 horsepower.</p></li>
<li><p>The team has 12 wind tunnel/dyno hours and 8 CFD sessions available this week.</p></li>
</ul>
<p><strong>Task:</strong> Formulate this as an LP and solve it using <code class="docutils literal notranslate"><span class="pre">scipy.optimize.linprog</span></code>. How many units of aero development and engine mapping should the team pursue to maximize total performance gain?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># EXERCISE 1: Solve the F1 development resource LP</span>
<span class="k">def</span><span class="w"> </span><span class="nf">solve_development_lp</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Formulate and solve the F1 development resource LP.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        Tuple of (aero_units, engine_units, max_performance)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># TODO: Implement this!</span>
    <span class="c1"># Hint: linprog MINIMIZES, so negate the objective for maximization.</span>
    <span class="c1"># Hint: c = [-8, -5] for the negated performance objective</span>
    <span class="c1"># Hint: A_ub represents [wind_tunnel_constraint, cfd_constraint]</span>
    
    <span class="k">pass</span>  <span class="c1"># Replace with your solution</span>

<span class="c1"># Test</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">solve_development_lp</span><span class="p">()</span>
<span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">aero_units</span><span class="p">,</span> <span class="n">engine_units</span><span class="p">,</span> <span class="n">max_performance</span> <span class="o">=</span> <span class="n">result</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Aero development units: </span><span class="si">{</span><span class="n">aero_units</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Engine mapping units: </span><span class="si">{</span><span class="n">engine_units</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Maximum performance gain: </span><span class="si">{</span><span class="n">max_performance</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="n">expected_performance</span> <span class="o">=</span> <span class="mf">34.40</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Expected performance: </span><span class="si">{</span><span class="n">expected_performance</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Correct: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">max_performance</span><span class="p">,</span><span class="w"> </span><span class="n">expected_performance</span><span class="p">,</span><span class="w"> </span><span class="n">atol</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="exercise-2-verify-convexity">
<h3>Exercise 2: Verify Convexity<a class="headerlink" href="#exercise-2-verify-convexity" title="Link to this heading">#</a></h3>
<p>Write a function that numerically checks whether a 1D function is convex over a given interval by testing the secant line condition at random points. Think of it as checking whether a setup parameter’s performance curve has a single “sweet spot” (convex) or multiple local optima (non-convex).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># EXERCISE 2: Check convexity numerically</span>
<span class="k">def</span><span class="w"> </span><span class="nf">is_convex</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">,</span> <span class="n">n_tests</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Numerically check if a function is convex over [x_min, x_max].</span>
<span class="sd">    </span>
<span class="sd">    A function is convex if for all x, y in the interval and lambda in [0,1]:</span>
<span class="sd">        f(lambda*x + (1-lambda)*y) &lt;= lambda*f(x) + (1-lambda)*f(y)</span>
<span class="sd">    </span>
<span class="sd">    In F1 terms: does interpolating between two setup values always give</span>
<span class="sd">    a lap time that&#39;s no worse than the weighted average? If yes, it&#39;s convex</span>
<span class="sd">    (one sweet spot). If no, there might be multiple local optima.</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        f: Function to test (e.g., lap time as a function of wing angle)</span>
<span class="sd">        x_min, x_max: Interval endpoints</span>
<span class="sd">        n_tests: Number of random tests</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        True if all tests pass (function appears convex), False otherwise</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># TODO: Implement this!</span>
    <span class="c1"># Hint: For each test, pick random x, y in [x_min, x_max]</span>
    <span class="c1">#       and random lambda in [0, 1], then check the inequality.</span>
    
    <span class="k">pass</span>  <span class="c1"># Replace with your solution</span>

<span class="c1"># Test with known functions (F1-themed descriptions)</span>
<span class="n">f_quadratic</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>          <span class="c1"># convex — like spring stiffness vs lap time</span>
<span class="n">f_absolute</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>       <span class="c1"># convex — like tire wear vs offset from optimal pressure</span>
<span class="n">f_sine</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>           <span class="c1"># NOT convex — like full aero map with multiple optima</span>
<span class="n">f_exp</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>            <span class="c1"># convex — like exponential degradation</span>

<span class="k">if</span> <span class="n">is_convex</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">is_convex</span><span class="p">(</span><span class="n">f_quadratic</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;x² (spring stiffness): convex = </span><span class="si">{</span><span class="n">is_convex</span><span class="p">(</span><span class="n">f_quadratic</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;|x| (tire pressure offset): convex = </span><span class="si">{</span><span class="n">is_convex</span><span class="p">(</span><span class="n">f_absolute</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sin(x) (aero map) on [-pi,pi]: convex = </span><span class="si">{</span><span class="n">is_convex</span><span class="p">(</span><span class="n">f_sine</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="w"> </span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;exp(x) (degradation curve): convex = </span><span class="si">{</span><span class="n">is_convex</span><span class="p">(</span><span class="n">f_exp</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Expected: True, True, False, True&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="exercise-3-lagrange-multipliers-by-hand-with-verification">
<h3>Exercise 3: Lagrange Multipliers by Hand (with Verification)<a class="headerlink" href="#exercise-3-lagrange-multipliers-by-hand-with-verification" title="Link to this heading">#</a></h3>
<p>An F1 team wants to minimize their combined aero drag and engine weight penalty:</p>
<div class="math notranslate nohighlight">
\[\min_{x,y} \; x^2 + 2y^2 \quad \text{subject to} \quad x + y = 3\]</div>
<p>where <span class="math notranslate nohighlight">\(x\)</span> represents the aero investment and <span class="math notranslate nohighlight">\(y\)</span> represents the engine investment, and they must allocate exactly 3 units of total development budget.</p>
<p><strong>Steps:</strong></p>
<ol class="arabic simple">
<li><p>Write the Lagrangian: <span class="math notranslate nohighlight">\(\mathcal{L} = x^2 + 2y^2 + \lambda(x + y - 3)\)</span></p></li>
<li><p>Set partial derivatives to zero and solve</p></li>
<li><p>Verify numerically</p></li>
<li><p>Interpret the Lagrange multiplier: how much would relaxing the budget by 1 unit improve performance?</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># EXERCISE 3: Lagrange multipliers for F1 budget allocation</span>
<span class="k">def</span><span class="w"> </span><span class="nf">solve_budget_allocation</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Solve: min x^2 + 2y^2 subject to x + y = 3</span>
<span class="sd">    </span>
<span class="sd">    F1 interpretation:</span>
<span class="sd">    - x = aero investment, y = engine investment</span>
<span class="sd">    - x^2 + 2y^2 = combined performance penalty (engine is more expensive per unit)</span>
<span class="sd">    - x + y = 3: total budget constraint</span>
<span class="sd">    </span>
<span class="sd">    Analytical steps:</span>
<span class="sd">    L = x^2 + 2y^2 + lambda*(x + y - 3)</span>
<span class="sd">    dL/dx = 2x + lambda = 0      -&gt; x = -lambda/2</span>
<span class="sd">    dL/dy = 4y + lambda = 0      -&gt; y = -lambda/4</span>
<span class="sd">    dL/dlambda = x + y - 3 = 0   -&gt; -lambda/2 - lambda/4 = 3</span>
<span class="sd">                                  -&gt; -3*lambda/4 = 3</span>
<span class="sd">                                  -&gt; lambda = -4</span>
<span class="sd">    So: x = 2 (aero), y = 1 (engine), lambda = -4</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        Tuple of (aero_opt, engine_opt, lambda_opt, penalty_opt)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># TODO: Return the analytical solution</span>
    <span class="c1"># Hint: Follow the steps in the docstring above</span>
    
    <span class="k">pass</span>  <span class="c1"># Replace with your solution</span>

<span class="c1"># Numerical verification</span>
<span class="n">result_num</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">xy</span><span class="p">:</span> <span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">x0</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="n">method</span><span class="o">=</span><span class="s1">&#39;SLSQP&#39;</span><span class="p">,</span>
    <span class="n">constraints</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;eq&#39;</span><span class="p">,</span> <span class="s1">&#39;fun&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">xy</span><span class="p">:</span> <span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">3</span><span class="p">}</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== Numerical Solution ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Aero investment = </span><span class="si">{</span><span class="n">result_num</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, Engine investment = </span><span class="si">{</span><span class="n">result_num</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Combined penalty = </span><span class="si">{</span><span class="n">result_num</span><span class="o">.</span><span class="n">fun</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">solve_budget_allocation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">solve_budget_allocation</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">aero_opt</span><span class="p">,</span> <span class="n">engine_opt</span><span class="p">,</span> <span class="n">lambda_opt</span><span class="p">,</span> <span class="n">penalty_opt</span> <span class="o">=</span> <span class="n">solve_budget_allocation</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== Your Analytical Solution ===&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Aero = </span><span class="si">{</span><span class="n">aero_opt</span><span class="si">}</span><span class="s2">, Engine = </span><span class="si">{</span><span class="n">engine_opt</span><span class="si">}</span><span class="s2">, lambda = </span><span class="si">{</span><span class="n">lambda_opt</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Combined penalty = </span><span class="si">{</span><span class="n">penalty_opt</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Match: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">([</span><span class="n">aero_opt</span><span class="p">,</span><span class="w"> </span><span class="n">engine_opt</span><span class="p">],</span><span class="w"> </span><span class="n">result_num</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">atol</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected: aero=2, engine=1, lambda=-4, penalty=6&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Interpretation: lambda = -4 means each additional unit of budget&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;would reduce the penalty by ~4 units. Valuable intel for the team principal!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== Numerical Solution ===
Aero investment = 2.0000, Engine investment = 1.0000
Combined penalty = 6.0000
</pre></div>
</div>
</div>
</div>
</section>
<section id="exercise-4-car-setup-landscape-explorer">
<h3>Exercise 4: Car Setup Landscape Explorer<a class="headerlink" href="#exercise-4-car-setup-landscape-explorer" title="Link to this heading">#</a></h3>
<p>Write a function that takes a 2D objective function (like lap time as a function of two setup parameters) and visualizes:</p>
<ol class="arabic simple">
<li><p>The contour plot (setup performance landscape)</p></li>
<li><p>The gradient descent path from a given starting setup</p></li>
<li><p>The final (approximate) optimal setup</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># EXERCISE 4: Build a car setup landscape explorer</span>
<span class="k">def</span><span class="w"> </span><span class="nf">explore_setup_landscape</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">grad_f</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
                            <span class="n">x_range</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">y_range</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Visualize a 2D setup optimization landscape with gradient descent path.</span>
<span class="sd">    </span>
<span class="sd">    Think of this as an engineer exploring the setup space: starting with an</span>
<span class="sd">    initial configuration and iteratively tweaking wing angle and ride height</span>
<span class="sd">    to find the fastest setup.</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        f: Objective function f(wing, ride) -&gt; lap_time_penalty</span>
<span class="sd">        grad_f: Gradient function grad_f(wing, ride) -&gt; (df/d_wing, df/d_ride)</span>
<span class="sd">        x0: Starting setup [wing_angle, ride_height]</span>
<span class="sd">        lr: Learning rate (size of each setup adjustment)</span>
<span class="sd">        n_steps: Number of setup iterations</span>
<span class="sd">        x_range: (min, max) for wing angle axis</span>
<span class="sd">        y_range: (min, max) for ride height axis</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># TODO: Implement this!</span>
    <span class="c1"># Step 1: Create meshgrid and compute Z = f(X, Y)</span>
    <span class="c1"># Step 2: Run gradient descent, storing the setup path</span>
    <span class="c1"># Step 3: Plot contours + path + start/end markers</span>
    <span class="c1"># Hint: Use ax.contourf for filled contours and ax.plot for the path</span>
    
    <span class="k">pass</span>  <span class="c1"># Replace with your solution</span>

<span class="c1"># Test with Rosenbrock function (a classic test — like a tricky setup landscape)</span>
<span class="c1"># The Rosenbrock &quot;valley&quot; is like a narrow setup window: easy to find the valley,</span>
<span class="c1"># hard to find the exact bottom.</span>
<span class="n">f_rosen</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">100</span><span class="o">*</span><span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="n">grad_rosen</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="p">(</span>
    <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">400</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span>
    <span class="mi">200</span><span class="o">*</span><span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Implement explore_setup_landscape() to visualize gradient descent on the&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Rosenbrock function (a notoriously tricky setup landscape).&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The optimal setup is at (1, 1) — but the narrow valley makes it hard to find.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Try different learning rates and starting setups!&quot;</span><span class="p">)</span>

<span class="c1"># Uncomment after implementing:</span>
<span class="c1"># explore_setup_landscape(f_rosen, grad_rosen, x0=[-1, -1], lr=0.001, n_steps=5000,</span>
<span class="c1">#                         x_range=(-2, 2), y_range=(-1, 3))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Implement explore_setup_landscape() to visualize gradient descent on the
Rosenbrock function (a notoriously tricky setup landscape).
The optimal setup is at (1, 1) — but the narrow valley makes it hard to find.
Try different learning rates and starting setups!
</pre></div>
</div>
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Link to this heading">#</a></h2>
<section id="key-concepts">
<h3>Key Concepts<a class="headerlink" href="#key-concepts" title="Link to this heading">#</a></h3>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Concept</p></th>
<th class="head"><p>Definition</p></th>
<th class="head"><p>F1 Parallel</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Optimization</strong></p></td>
<td><p>Finding the best solution from a feasible set (objective + variables + constraints)</p></td>
<td><p>Finding the fastest legal race strategy</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Linear programming</strong></p></td>
<td><p>Optimizing a linear objective subject to linear constraints; solution at a vertex</p></td>
<td><p>Tire/fuel allocation under FIA rules; best strategy is at a regulation boundary</p></td>
</tr>
<tr class="row-even"><td><p><strong>Simplex method</strong></p></td>
<td><p>Solve LPs by hopping between adjacent vertices, always improving</p></td>
<td><p>Strategist testing neighboring pit lap options until no tweak helps</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Duality</strong></p></td>
<td><p>Every LP has an alternative (dual) formulation; strong duality means same optimal value</p></td>
<td><p>Team principal’s view vs driver’s view of the same resource allocation</p></td>
</tr>
<tr class="row-even"><td><p><strong>Convexity</strong></p></td>
<td><p>Key property ensuring local minima are global minima; gradient descent works</p></td>
<td><p>Single-parameter setup (one sweet spot) vs full car design (many local optima)</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Lagrange multipliers</strong></p></td>
<td><p>Solve equality-constrained problems via gradient alignment</p></td>
<td><p>Shadow price of FIA regulations (“seconds per kg of weight relief”)</p></td>
</tr>
<tr class="row-even"><td><p><strong>KKT conditions</strong></p></td>
<td><p>Generalize Lagrange multipliers to inequality constraints; complementary slackness identifies active constraints</p></td>
<td><p>Only the regulations you are pushing against actually shape the car</p></td>
</tr>
<tr class="row-odd"><td><p><strong>ML is optimization</strong></p></td>
<td><p>SVMs solve QPs, regularization is dual to constraints, losses are designed to be convex</p></td>
<td><p>F1 engineering is constrained optimization at every level</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="id13">
<h3>Connection to Machine Learning<a class="headerlink" href="#id13" title="Link to this heading">#</a></h3>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Concept from this Notebook</p></th>
<th class="head"><p>Where You Will See It in ML</p></th>
<th class="head"><p>F1 Parallel</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Objective function</p></td>
<td><p>Every loss function (MSE, cross-entropy, hinge)</p></td>
<td><p>Lap time (the ultimate objective)</p></td>
</tr>
<tr class="row-odd"><td><p>Feasible region / constraints</p></td>
<td><p>Regularization (<span class="math notranslate nohighlight">\(\ell_1\)</span>, <span class="math notranslate nohighlight">\(\ell_2\)</span>), fairness constraints</p></td>
<td><p>FIA regulations bounding the design space</p></td>
</tr>
<tr class="row-even"><td><p>Convexity</p></td>
<td><p>Guarantees for logistic regression, SVM, LASSO</p></td>
<td><p>Spring stiffness has one optimal; car design does not</p></td>
</tr>
<tr class="row-odd"><td><p>Non-convexity</p></td>
<td><p>Neural network training challenges</p></td>
<td><p>Why teams sometimes need a radical concept reset</p></td>
</tr>
<tr class="row-even"><td><p>Lagrange multipliers / KKT</p></td>
<td><p>SVM support vectors, dual formulations</p></td>
<td><p>Shadow price of each regulation on lap time</p></td>
</tr>
<tr class="row-odd"><td><p>Duality</p></td>
<td><p>Kernel trick in SVMs, ELBO in variational inference</p></td>
<td><p>Same allocation problem from team vs driver perspective</p></td>
</tr>
<tr class="row-even"><td><p>Linear programming</p></td>
<td><p>Resource allocation, network optimization</p></td>
<td><p>Pit stop timing, tire compound selection, budget split</p></td>
</tr>
<tr class="row-odd"><td><p>Gradient descent (preview)</p></td>
<td><p>The topic of the next notebook!</p></td>
<td><p>How engineers iteratively refine a setup</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="checklist">
<h3>Checklist<a class="headerlink" href="#checklist" title="Link to this heading">#</a></h3>
<p>Before moving on, make sure you can:</p>
<ul class="simple">
<li><p>[ ] Define an optimization problem with objective, variables, and constraints</p></li>
<li><p>[ ] Formulate an LP in standard form and solve it with <code class="docutils literal notranslate"><span class="pre">linprog</span></code></p></li>
<li><p>[ ] Explain why LP solutions occur at vertices (and why the best F1 strategy pushes regulation limits)</p></li>
<li><p>[ ] Describe the Simplex method’s vertex-hopping strategy</p></li>
<li><p>[ ] State weak and strong duality theorems</p></li>
<li><p>[ ] Distinguish convex from non-convex functions (setup tuning vs car design)</p></li>
<li><p>[ ] Explain why convexity guarantees a global optimum</p></li>
<li><p>[ ] Set up and solve a Lagrangian for equality constraints</p></li>
<li><p>[ ] State the four KKT conditions and explain complementary slackness</p></li>
<li><p>[ ] Frame an SVM as a constrained optimization problem</p></li>
<li><p>[ ] Explain regularization as a Lagrangian constraint (the budget cap analogy)</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="next-steps">
<h2>Next Steps<a class="headerlink" href="#next-steps" title="Link to this heading">#</a></h2>
<p>Continue to <strong>Part 3.3: Gradient-Based Optimization</strong> where we will cover:</p>
<ul class="simple">
<li><p>Gradient descent and its variants (SGD, momentum, Adam)</p></li>
<li><p>Learning rate schedules and convergence theory</p></li>
<li><p>Automatic differentiation</p></li>
<li><p>How these methods actually train neural networks</p></li>
</ul>
<p><strong>Looking ahead:</strong> Now that you understand <em>what</em> optimization is and <em>when</em> it works well (convexity), the next notebook focuses on <em>how</em> we actually solve optimization problems in practice — with gradients. Every deep learning training loop is gradient descent applied to a (usually non-convex) loss function. And just like an F1 engineer tweaking setup parameters one session at a time, gradient descent iteratively moves toward the optimum — one step at a time, guided by the slope of the landscape.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="06_classical_ml.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Part 3.1: Classical Machine Learning</p>
      </div>
    </a>
    <a class="right-next"
       href="08_optimization_theory.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Part 3.3: Optimization Theory for Machine Learning</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-objectives">Learning Objectives</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-optimization">1. What is Optimization?</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#intuitive-explanation">Intuitive Explanation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-f1-connection">The F1 Connection</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deep-dive-types-of-optimization-problems">Deep Dive: Types of Optimization Problems</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#key-insight">Key Insight</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-programming">2. Linear Programming</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Intuitive Explanation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#breaking-down-the-formula">Breaking down the formula:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">The F1 Connection</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#geometric-intuition">Geometric Intuition</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deep-dive-why-lps-always-have-vertex-solutions">Deep Dive: Why LPs Always Have Vertex Solutions</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#common-misconceptions">Common Misconceptions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-simplex-method">3. The Simplex Method</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Intuitive Explanation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">The F1 Connection</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deep-dive-simplex-vs-interior-point-methods">Deep Dive: Simplex vs Interior Point Methods</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#duality-theory">4. Duality Theory</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Intuitive Explanation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">The F1 Connection</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-duality-theorems">Key Duality Theorems</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deep-dive-why-duality-matters-in-ml">Deep Dive: Why Duality Matters in ML</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">Key Insight</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#convex-optimization">5. Convex Optimization</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">Intuitive Explanation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">The F1 Connection</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#why-convexity-matters">Why Convexity Matters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deep-dive-common-convex-functions-in-ml">Deep Dive: Common Convex Functions in ML</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">Key Insight</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#constrained-optimization-lagrange-multipliers">6. Constrained Optimization &amp; Lagrange Multipliers</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">Intuitive Explanation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">The F1 Connection</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#kkt-conditions-the-full-picture">KKT Conditions: The Full Picture</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deep-dive-complementary-slackness-the-either-or-rule">Deep Dive: Complementary Slackness — The Either/Or Rule</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#connection-to-machine-learning">7. Connection to Machine Learning</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ml-as-optimization">ML as Optimization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#why-this-matters-in-machine-learning">Why This Matters in Machine Learning</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1-formulate-and-solve-a-race-strategy-lp">Exercise 1: Formulate and Solve a Race Strategy LP</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2-verify-convexity">Exercise 2: Verify Convexity</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3-lagrange-multipliers-by-hand-with-verification">Exercise 3: Lagrange Multipliers by Hand (with Verification)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4-car-setup-landscape-explorer">Exercise 4: Car Setup Landscape Explorer</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-concepts">Key Concepts</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">Connection to Machine Learning</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#checklist">Checklist</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#next-steps">Next Steps</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Dan Shah
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>